/*! max.ui5.js - v5.0.5 - 2018-11-12 */
var Hogan={},uuid;!function(t,e){t.Template=function(t,e,i,n){this.r=t||this.r,this.c=i,this.options=n,this.text=e||"",this.buf=""},t.Template.prototype={r:function(t,e,i){return""},v:function(t){return t=c(t),s.test(t)?t.replace(i,"&amp;").replace(n,"&lt;").replace(a,"&gt;").replace(r,"&#39;").replace(o,"&quot;"):t},t:c,render:function(t,e,i){return this.ri([t],e||{},i)},ri:function(t,e,i){return this.r(t,e,i)},rp:function(t,e,i,n){var a=i[t];return a?(this.c&&"string"==typeof a&&(a=this.c.compile(a,this.options)),a.ri(e,i,n)):""},rs:function(t,e,i){var n=t[t.length-1];if(u(n))for(var a=0;a<n.length;a++)t.push(n[a]),i(t,e,this),t.pop();else i(t,e,this)},s:function(t,e,i,n,a,r,o){var s;return(!u(t)||0!==t.length)&&("function"==typeof t&&(t=this.ls(t,e,i,n,a,r,o)),s=""===t||!!t,!n&&s&&e&&e.push("object"==typeof t?t:e[e.length-1]),s)},d:function(t,e,i,n){var a=t.split("."),r=this.f(a[0],e,i,n),o=null;if("."===t&&u(e[e.length-2]))return e[e.length-1];for(var s=1;s<a.length;s++)r=r&&"object"==typeof r&&a[s]in r?(o=r)[a[s]]:"";return!(n&&!r)&&(n||"function"!=typeof r||(e.push(o),r=this.lv(r,e,i),e.pop()),r)},f:function(t,e,i,n){for(var a=!1,r=null,o=!1,s=e.length-1;0<=s;s--)if((r=e[s])&&"object"==typeof r&&t in r){a=r[t],o=!0;break}return o?(n||"function"!=typeof a||(a=this.lv(a,e,i)),a):!n&&""},ho:function(t,e,i,n,a){var r=this.c,o=this.options;return o.delimiters=a,n=null==(n=t.call(e,n))?String(n):n.toString(),this.b(r.compile(n,o).render(e,i)),!1},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ls:function(t,e,i,n,a,r,o){var s,c=e[e.length-1];if(!n&&this.c&&0<t.length)return this.ho(t,c,i,this.text.substring(a,r),o);if("function"==typeof(s=t.call(c))){if(n)return!0;if(this.c)return this.ho(s,c,i,this.text.substring(a,r),o)}return s},lv:function(t,e,i){var n=e[e.length-1],a=t.call(n);return"function"==typeof a&&(a=c(a.call(n)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(n,i):c(a)}};var i=/&/g,n=/</g,a=/>/g,r=/\'/g,o=/\"/g,s=/[&<>\"\']/;function c(t){return String(null==t?"":t)}var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}("undefined"!=typeof exports?exports:Hogan),function(a){var w=/\S/,e=/\"/g,i=/\n/g,n=/\r/g,r=/\\/g,_={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};function b(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function C(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function S(t,e,i){if(e.charAt(i)!=t.charAt(0))return!1;for(var n=1,a=t.length;n<a;n++)if(e.charAt(i+n)!=t.charAt(n))return!1;return!0}function c(t,e){for(var i=0,n=e.length;i<n;i++)if(e[i].o==t.n)return t.tag="#",!0}function u(t,e,i){for(var n=0,a=i.length;n<a;n++)if(i[n].c==t&&i[n].o==e)return!0}function h(t){return t.replace(r,"\\\\").replace(e,'\\"').replace(i,"\\n").replace(n,"\\r")}function g(t){return~t.indexOf(".")?"d":"f"}function y(t){for(var e,i,n,a,r,o,s,c,u,l,d,f="",p=0,m=t.length;p<m;p++){var v=t[p].tag;"#"==v?f+=(o=t[p].nodes,s=t[p].n,c=g(t[p].n),u=t[p].i,l=t[p].end,d=t[p].otag+" "+t[p].ctag,"if(_.s(_."+c+'("'+h(s)+'",c,p,1),c,p,0,'+u+","+l+',"'+d+'")){_.rs(c,p,function(c,p,_){'+y(o)+"});c.pop();}"):"^"==v?f+=(a=t[p].nodes,r=t[p].n,"if(!_.s(_."+g(t[p].n)+'("'+h(r)+'",c,p,1),c,p,1,0,0,"")){'+y(a)+"};"):"<"==v||">"==v?f+='_.b(_.rp("'+h((n=t[p]).n)+'",c,p,"'+(n.indent||"")+'"));':"{"==v||"&"==v?f+=(i=t[p].n,"_.b(_.t(_."+g(t[p].n)+'("'+h(i)+'",c,p,0)));'):"\n"==v?f+=x('"\\n"'+(t.length-1==p?"":" + i")):"_v"==v?f+=(e=t[p].n,"_.b(_.v(_."+g(t[p].n)+'("'+h(e)+'",c,p,0)));'):void 0===v&&(f+=x('"'+h(t[p])+'"'))}return f}function x(t){return"_.b("+t+");"}a.scan=function(t,e){var i,n,a,r,o,s=t.length,c=0,u=null,l=null,d="",f=[],p=!1,m=0,v=0,h="{{",g="}}";function y(){0<d.length&&(f.push(new String(d)),d="")}function x(t,e){if(y(),t&&function(){for(var t=!0,e=v;e<f.length;e++)if(!(t=f[e].tag&&_[f[e].tag]<_._v||!f[e].tag&&null===f[e].match(w)))return!1;return t}())for(var i,n=v;n<f.length;n++)f[n].tag||((i=f[n+1])&&">"==i.tag&&(i.indent=f[n].toString()),f.splice(n,1));else e||f.push({tag:"\n"});p=!1,v=f.length}for(e&&(e=e.split(" "),h=e[0],g=e[1]),m=0;m<s;m++)0==c?S(h,t,m)?(--m,y(),c=1):"\n"==t.charAt(m)?x(p):d+=t.charAt(m):1==c?(m+=h.length-1,c="="==(u=(l=_[t.charAt(m+1)])?t.charAt(m+1):"_v")?(n=m,void 0,a="="+g,r=(i=t).indexOf(a,n),o=C(i.substring(i.indexOf("=",n)+1,r)).split(" "),h=o[0],g=o[1],m=r+a.length-1,0):(l&&m++,2),p=m):S(g,t,m)?(f.push({tag:u,n:C(d),otag:h,ctag:g,i:"/"==u?p-g.length:m+h.length}),d="",m+=g.length-1,c=0,"{"==u&&("}}"==g?m++:b(f[f.length-1]))):d+=t.charAt(m);return x(p,!0),f},a.generate=function(t,e,i){var n='var _=this;_.b(i=i||"");'+y(t)+"return _.fl();";return i.asString?"function(c,p,i){"+n+";}":new a.Template(new Function("c","p","i",n),e,a,i)},a.parse=function(t,e,i){return function t(e,i,n,a){for(var r=[],o=null,s=null;0<e.length;)if("#"==(s=e.shift()).tag||"^"==s.tag||c(s,a))n.push(s),s.nodes=t(e,s.tag,n,a),r.push(s);else{if("/"==s.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+s.n);if(o=n.pop(),s.n!=o.n&&!u(s.n,o.n,a))throw new Error("Nesting error: "+o.n+" vs. "+s.n);return o.end=s.i,r}r.push(s)}if(0<n.length)throw new Error("missing closing tag: "+n.pop().n);return r}(t,0,[],(i=i||{}).sectionTags||[])},a.cache={},a.compile=function(t,e){var i=t+"||"+!!(e=e||{}).asString,n=this.cache[i];return n||(n=this.generate(this.parse(this.scan(t,e.delimiters),t,e),t,e),this.cache[i]=n)}}("undefined"!=typeof exports?exports:Hogan),function(c){c.easydate={},c.easydate.locales={},c.easydate.locales.en={future_format:"%s %t",past_format:"%t %s",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years",yesterday:"yesterday",tomorrow:"tomorrow",now:"just now",ago:"ago",in:"in"},c.easydate.locales.ca={future_format:"%s %t",past_format:"%s %t",second:"segon",seconds:"segons",minute:"minut",minutes:"minuts",hour:"hora",hours:"hores",day:"dia",days:"dies",week:"setmana",weeks:"setmanes",month:"mes",months:"mesos",year:"any",years:"anys",yesterday:"ahir",tomorrow:"demà",now:"fa un moment",ago:"fa",in:"en"},c.easydate.locales.es={future_format:"%s %t",past_format:"%s %t",second:"segundo",seconds:"segundos",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"dia",days:"dias",week:"semana",weeks:"semanas",month:"mes",months:"meses",year:"año",years:"años",yesterday:"ayer",tomorrow:"mañana",now:"hace un instante",ago:"hace",in:"en"};var u={live:!0,set_title:!0,format_future:!0,format_past:!0,units:[{name:"now",limit:5},{name:"second",limit:60,in_seconds:1},{name:"minute",limit:3600,in_seconds:60},{name:"hour",limit:86400,in_seconds:3600},{name:"yesterday",limit:172800,past_only:!0},{name:"tomorrow",limit:172800,future_only:!0},{name:"day",limit:604800,in_seconds:86400},{name:"week",limit:2629743,in_seconds:604800},{name:"month",limit:31556926,in_seconds:2629743},{name:"year",limit:1/0,in_seconds:31556926}],uneasy_format:function(t){return t.toLocaleDateString()},locale:c.easydate.locales.en};function l(t,e,i){return isNaN(e)||1==e||(t+="s"),i.locale[t]||t}c.easydate.format_date=function(t,e){var i=c.extend({},u);i.locale=c.easydate.locales[e];var n=((new Date).getTime()-t.getTime())/1e3,a=Math.abs(n);if(!isNaN(n)&&!(!i.format_future&&n<0||!i.format_past&&0<n)){for(var r in i.units){var o=i.units[r];if(!(o.past_only&&n<0||o.future_only&&0<n)&&a<o.limit){if(isNaN(o.in_seconds))return l(o.name,NaN,i);var s=a/o.in_seconds;return s=Math.round(s),(n<0?l("future_format",NaN,i).replace("%s",l("in",NaN,i)):l("past_format",NaN,i).replace("%s",l("ago",NaN,i))).replace("%t",s+" "+l(o.name,s,i))}}return i.uneasy_format(t)}}}(jQuery),function(t){var e;t.ajaxSettings.xdr=function(){return window.XDomainRequest?new window.XDomainRequest:null},e=t.ajaxSettings.xdr(),t.extend(t.support,{iecors:!!e}),t.support.iecors&&t.ajaxTransport(function(i){var n=i.xdr();return{send:function(t,e){n.onload=function(){var t={"Content-Type":n.contentType};e(200,"OK",{text:n.responseText},t)},i.xhrFields&&(xhr.onerror=i.xhrFields.error,xhr.ontimeout=i.xhrFields.timeout),n.open(i.type,i.url),n.send(i.hasContent&&i.data||null)},abort:function(){n.abort()}}})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(u){var l,d,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(u.event.fixHooks)for(var i=t.length;i;)u.event.fixHooks[t[--i]]=u.event.mouseHooks;var n=u.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],a,!1);else this.onmousewheel=a;u.data(this,"mousewheel-line-height",n.getLineHeight(this)),u.data(this,"mousewheel-page-height",n.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],a,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(u(t)["offsetParent"in u.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return u(t).height()},settings:{adjustOldDeltas:!0}};function a(t){var e,i=t||window.event,n=f.call(arguments,1),a=0,r=0,o=0;if((t=u.event.fix(i)).type="mousewheel","detail"in i&&(o=-1*i.detail),"wheelDelta"in i&&(o=i.wheelDelta),"wheelDeltaY"in i&&(o=i.wheelDeltaY),"wheelDeltaX"in i&&(r=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(r=-1*o,o=0),a=0===o?r:o,"deltaY"in i&&(a=o=-1*i.deltaY),"deltaX"in i&&(r=i.deltaX,0===o&&(a=-1*r)),0!==o||0!==r){if(1===i.deltaMode){var s=u.data(this,"mousewheel-line-height");a*=s,o*=s,r*=s}else if(2===i.deltaMode){var c=u.data(this,"mousewheel-page-height");a*=c,o*=c,r*=c}return e=Math.max(Math.abs(o),Math.abs(r)),(!d||e<d)&&m(i,d=e)&&(d/=40),m(i,e)&&(a/=40,r/=40,o/=40),a=Math[1<=a?"floor":"ceil"](a/d),r=Math[1<=r?"floor":"ceil"](r/d),o=Math[1<=o?"floor":"ceil"](o/d),t.deltaX=r,t.deltaY=o,t.deltaFactor=d,t.deltaMode=0,n.unshift(t,a,r,o),l&&clearTimeout(l),l=setTimeout(p,200),(u.event.dispatch||u.event.handle).apply(this,n)}}function p(){d=null}function m(t,e){return n.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}u.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return t<10?"0"+t:t}var cx,escapable,gap,indent,meta,rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,a,r,o,s=gap,c=e[t];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,i=0;i<r;i+=1)o[i]=str(i,c)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;i<r;i+=1)"string"==typeof rep[i]&&(a=str(n=rep[i],c))&&o.push(quote(n)+(gap?": ":":")+a);else for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(a=str(n,c))&&o.push(quote(n)+(gap?": ":":")+a);return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,i){var n;if(indent=gap="","number"==typeof i)for(n=0;n<i;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if((rep=e)&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){var j;function walk(t,e){var i,n,a=t[e];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(void 0!==(n=walk(a,i))?a[i]=n:delete a[i]);return reviver.call(t,e,a)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),SockJS=function(){var l=document,d=window,f={},t=function(){};t.prototype.addEventListener=function(t,e){this._listeners||(this._listeners={}),t in this._listeners||(this._listeners[t]=[]);var i=this._listeners[t];-1===f.arrIndexOf(i,e)&&i.push(e)},t.prototype.removeEventListener=function(t,e){if(this._listeners&&t in this._listeners){var i=this._listeners[t],n=f.arrIndexOf(i,e);-1===n||(1<i.length?this._listeners[t]=i.slice(0,n).concat(i.slice(n+1)):delete this._listeners[t])}},t.prototype.dispatchEvent=function(t){var e=t.type,i=Array.prototype.slice.call(arguments,0);if(this["on"+e]&&this["on"+e].apply(this,i),this._listeners&&e in this._listeners)for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].apply(this,i)};var s=function(t,e){if(this.type=t,void 0!==e)for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i])};s.prototype.toString=function(){var t=[];for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];"function"==typeof i&&(i="[function]"),t.push(e+"="+i)}return"SimpleEvent("+t.join(", ")+")"};var e=function(t){this._events=t||[],this._listeners={}};e.prototype.emit=function(t){var e=this;if(e._verifyType(t),!e._nuked){var i=Array.prototype.slice.call(arguments,1);if(e["on"+t]&&e["on"+t].apply(e,i),t in e._listeners)for(var n=0;n<e._listeners[t].length;n++)e._listeners[t][n].apply(e,i)}},e.prototype.on=function(t,e){var i=this;i._verifyType(t),i._nuked||(t in i._listeners||(i._listeners[t]=[]),i._listeners[t].push(e))},e.prototype._verifyType=function(t){-1===f.arrIndexOf(this._events,t)&&f.log("Event "+JSON.stringify(t)+" not listed "+JSON.stringify(this._events)+" in "+this)},e.prototype.nuke=function(){var t=this;t._nuked=!0;for(var e=0;e<t._events.length;e++)delete t[t._events[e]];t._listeners={}};var a="abcdefghijklmnopqrstuvwxyz0123456789_";f.random_string=function(t,e){e=e||a.length;var i,n=[];for(i=0;i<t;i++)n.push(a.substr(Math.floor(Math.random()*e),1));return n.join("")},f.random_number=function(t){return Math.floor(Math.random()*t)},f.random_number_string=function(t){var e=(""+(t-1)).length;return(Array(e+1).join("0")+f.random_number(t)).slice(-e)},f.getOrigin=function(t){return(t+="/").split("/").slice(0,3).join("/")},f.isSameOriginUrl=function(t,e){return e||(e=d.location.href),t.split("/").slice(0,3).join("/")===e.split("/").slice(0,3).join("/")},f.getParentDomain=function(t){return/^[0-9.]*$/.test(t)?t:/^\[/.test(t)?t:/[.]/.test(t)?t.split(".").slice(1).join("."):t},f.objectExtend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t};var i="_jp";f.polluteGlobalNamespace=function(){i in d||(d._jp={})},f.closeFrame=function(t,e){return"c"+JSON.stringify([t,e])},f.userSetCode=function(t){return 1e3===t||3e3<=t&&t<=4999},f.countRTO=function(t){return 100<t?3*t:t+200},f.log=function(){d.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)},f.bind=function(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}},f.flatUrl=function(t){return-1===t.indexOf("?")&&-1===t.indexOf("#")},f.amendUrl=function(t){var e=l.location;if(!t)throw new Error("Wrong url for SockJS");if(!f.flatUrl(t))throw new Error("Only basic urls are supported in SockJS");return 0===t.indexOf("//")&&(t=e.protocol+t),0===t.indexOf("/")&&(t=e.protocol+"//"+e.host+t),t=t.replace(/[/]+$/,"")},f.arrIndexOf=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},f.arrSkip=function(t,e){var i=f.arrIndexOf(t,e);return-1===i?t.slice():t.slice(0,i).concat(t.slice(i+1))},f.isArray=Array.isArray||function(t){return 0<={}.toString.call(t).indexOf("Array")},f.delay=function(t,e){return"function"==typeof t&&(e=t,t=0),setTimeout(e,t)};var n,r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\0":"\\u0000","":"\\u0001","":"\\u0002","":"\\u0003","":"\\u0004","":"\\u0005","":"\\u0006","":"\\u0007","\b":"\\b","\t":"\\t","\n":"\\n","\v":"\\u000b","\f":"\\f","\r":"\\r","":"\\u000e","":"\\u000f","":"\\u0010","":"\\u0011","":"\\u0012","":"\\u0013","":"\\u0014","":"\\u0015","":"\\u0016","":"\\u0017","":"\\u0018","":"\\u0019","":"\\u001a","":"\\u001b","":"\\u001c","":"\\u001d","":"\\u001e","":"\\u001f",'"':'\\"',"\\":"\\\\","":"\\u007f","":"\\u0080","":"\\u0081","":"\\u0082","":"\\u0083","":"\\u0084","":"\\u0085","":"\\u0086","":"\\u0087","":"\\u0088","":"\\u0089","":"\\u008a","":"\\u008b","":"\\u008c","":"\\u008d","":"\\u008e","":"\\u008f","":"\\u0090","":"\\u0091","":"\\u0092","":"\\u0093","":"\\u0094","":"\\u0095","":"\\u0096","":"\\u0097","":"\\u0098","":"\\u0099","":"\\u009a","":"\\u009b","":"\\u009c","":"\\u009d","":"\\u009e","":"\\u009f","­":"\\u00ad","؀":"\\u0600","؁":"\\u0601","؂":"\\u0602","؃":"\\u0603","؄":"\\u0604","܏":"\\u070f","឴":"\\u17b4","឵":"\\u17b5","‌":"\\u200c","‍":"\\u200d","‎":"\\u200e","‏":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","‪":"\\u202a","‫":"\\u202b","‬":"\\u202c","‭":"\\u202d","‮":"\\u202e"," ":"\\u202f","⁠":"\\u2060","⁡":"\\u2061","⁢":"\\u2062","⁣":"\\u2063","⁤":"\\u2064","⁥":"\\u2065","⁦":"\\u2066","⁧":"\\u2067","⁨":"\\u2068","⁩":"\\u2069","⁪":"\\u206a","⁫":"\\u206b","⁬":"\\u206c","⁭":"\\u206d","⁮":"\\u206e","⁯":"\\u206f","\ufeff":"\\ufeff","￰":"\\ufff0","￱":"\\ufff1","￲":"\\ufff2","￳":"\\ufff3","￴":"\\ufff4","￵":"\\ufff5","￶":"\\ufff6","￷":"\\ufff7","￸":"\\ufff8","￹":"\\ufff9","￺":"\\ufffa","￻":"\\ufffb","￼":"\\ufffc","�":"\\ufffd","￾":"\\ufffe","￿":"\\uffff"},c=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,u=JSON&&JSON.stringify||function(t){return r.lastIndex=0,r.test(t)&&(t=t.replace(r,function(t){return o[t]})),'"'+t+'"'};f.quote=function(t){var e=u(t);return c.lastIndex=0,c.test(e)?(n||(n=function(t){var e,i={},n=[];for(e=0;e<65536;e++)n.push(String.fromCharCode(e));return t.lastIndex=0,n.join("").replace(t,function(t){return i[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,i}(c)),e.replace(c,function(t){return n[t]})):e};var p=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];f.probeProtocols=function(){for(var t={},e=0;e<p.length;e++){var i=p[e];t[i]=w[i]&&w[i].enabled()}return t},f.detectProtocols=function(t,e,i){var n={},a=[];e||(e=p);for(var r=0;r<e.length;r++){var o=e[r];n[o]=t[o]}var s=function(t){var e=t.shift();n[e]?a.push(e):0<t.length&&s(t)};return!1!==i.websocket&&s(["websocket"]),n["xhr-streaming"]&&!i.null_origin?a.push("xhr-streaming"):!n["xdr-streaming"]||i.cookie_needed||i.null_origin?s(["iframe-eventsource","iframe-htmlfile"]):a.push("xdr-streaming"),n["xhr-polling"]&&!i.null_origin?a.push("xhr-polling"):!n["xdr-polling"]||i.cookie_needed||i.null_origin?s(["iframe-xhr-polling","jsonp-polling"]):a.push("xdr-polling"),a};var m="_sockjs_global";f.createHook=function(){var t="a"+f.random_string(8);if(!(m in d)){var e={};d[m]=function(t){return t in e||(e[t]={id:t,del:function(){delete e[t]}}),e[t]}}return d[m](t)},f.attachMessage=function(t){f.attachEvent("message",t)},f.attachEvent=function(t,e){void 0!==d.addEventListener?d.addEventListener(t,e,!1):(l.attachEvent("on"+t,e),d.attachEvent("on"+t,e))},f.detachMessage=function(t){f.detachEvent("message",t)},f.detachEvent=function(t,e){void 0!==d.addEventListener?d.removeEventListener(t,e,!1):(l.detachEvent("on"+t,e),d.detachEvent("on"+t,e))};var v={},h=!1,g=function(){for(var t in v)v[t](),delete v[t]};f.attachEvent("unload",function(){h||(h=!0,g())}),f.unload_add=function(t){var e=f.random_string(8);return v[e]=t,h&&f.delay(g),e},f.unload_del=function(t){t in v&&delete v[t]},f.createIframe=function(t,e){var i,n,a=l.createElement("iframe"),r=function(){clearTimeout(i);try{a.onload=null}catch(t){}a.onerror=null},o=function(){a&&(r(),setTimeout(function(){a&&a.parentNode.removeChild(a),a=null},0),f.unload_del(n))},s=function(t){a&&(o(),e(t))};return a.src=t,a.style.display="none",a.style.position="absolute",a.onerror=function(){s("onerror")},a.onload=function(){clearTimeout(i),i=setTimeout(function(){s("onload timeout")},2e3)},l.body.appendChild(a),i=setTimeout(function(){s("timeout")},15e3),n=f.unload_add(o),{post:function(t,e){try{a&&a.contentWindow&&a.contentWindow.postMessage(t,e)}catch(t){}},cleanup:o,loaded:r}},f.createHtmlfile=function(t,e){var i,n,a,r=new ActiveXObject("htmlfile"),o=function(){clearTimeout(i)},s=function(){r&&(o(),f.unload_del(n),a.parentNode.removeChild(a),a=r=null,CollectGarbage())};r.open(),r.write('<html><script>document.domain="'+document.domain+'";<\/script></html>'),r.close(),r.parentWindow._jp=d._jp;var c=r.createElement("div");return r.body.appendChild(c),a=r.createElement("iframe"),c.appendChild(a),a.src=t,i=setTimeout(function(){var t;t="timeout",r&&(s(),e(t))},15e3),n=f.unload_add(s),{post:function(t,e){try{a&&a.contentWindow&&a.contentWindow.postMessage(t,e)}catch(t){}},cleanup:s,loaded:o}};var y=function(){};(y.prototype=new e(["chunk","finish"]))._start=function(t,e,i,n){var a=this;try{a.xhr=new XMLHttpRequest}catch(t){}if(!a.xhr)try{a.xhr=new d.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}(d.ActiveXObject||d.XDomainRequest)&&(e+=(-1===e.indexOf("?")?"?":"&")+"t="+ +new Date),a.unload_ref=f.unload_add(function(){a._cleanup(!0)});try{a.xhr.open(t,e,!0)}catch(t){return a.emit("finish",0,""),void a._cleanup()}if(n&&n.no_credentials||(a.xhr.withCredentials="true"),n&&n.headers)for(var r in n.headers)a.xhr.setRequestHeader(r,n.headers[r]);a.xhr.onreadystatechange=function(){if(a.xhr){var t=a.xhr;switch(t.readyState){case 3:try{var e=t.status,i=t.responseText}catch(t){}1223===e&&(e=204),i&&0<i.length&&a.emit("chunk",e,i);break;case 4:1223===(e=t.status)&&(e=204),a.emit("finish",e,t.responseText),a._cleanup(!1)}}},a.xhr.send(i)},y.prototype._cleanup=function(t){var e=this;if(e.xhr){if(f.unload_del(e.unload_ref),e.xhr.onreadystatechange=function(){},t)try{e.xhr.abort()}catch(t){}e.unload_ref=e.xhr=null}},y.prototype.close=function(){this.nuke(),this._cleanup(!0)},(f.XHRCorsObject=function(){var t=this,e=arguments;f.delay(function(){t._start.apply(t,e)})}).prototype=new y,(f.XHRLocalObject=function(t,e,i){var n=this;f.delay(function(){n._start(t,e,i,{no_credentials:!0})})}).prototype=new y;var x=f.XDRObject=function(t,e,i){var n=this;f.delay(function(){n._start(t,e,i)})};x.prototype=new e(["chunk","finish"]),x.prototype._start=function(t,e,i){var n=this,a=new XDomainRequest;e+=(-1===e.indexOf("?")?"?":"&")+"t="+ +new Date;var r=a.ontimeout=a.onerror=function(){n.emit("finish",0,""),n._cleanup(!1)};a.onprogress=function(){n.emit("chunk",200,a.responseText)},a.onload=function(){n.emit("finish",200,a.responseText),n._cleanup(!1)},n.xdr=a,n.unload_ref=f.unload_add(function(){n._cleanup(!0)});try{n.xdr.open(t,e),n.xdr.send(i)}catch(t){r()}},x.prototype._cleanup=function(t){var e=this;if(e.xdr){if(f.unload_del(e.unload_ref),e.xdr.ontimeout=e.xdr.onerror=e.xdr.onprogress=e.xdr.onload=null,t)try{e.xdr.abort()}catch(t){}e.unload_ref=e.xdr=null}},x.prototype.close=function(){this.nuke(),this._cleanup(!0)},f.isXHRCorsCapable=function(){return d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:d.XDomainRequest&&l.domain?2:M.enabled()?3:4};var w=function(t,e,i){if(this===d)return new w(t,e,i);var n,a=this;a._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0},i&&f.objectExtend(a._options,i),a._base_url=f.amendUrl(t),a._server=a._options.server||f.random_number_string(1e3),a._options.protocols_whitelist&&a._options.protocols_whitelist.length?n=a._options.protocols_whitelist:(n="string"==typeof e&&0<e.length?[e]:f.isArray(e)?e:null)&&a._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.'),a._protocols=[],a.protocol=null,a.readyState=w.CONNECTING,a._ir=F(a._base_url),a._ir.onfinish=function(t,e){a._ir=null,t?(a._options.info&&(t=f.objectExtend(t,a._options.info)),a._options.rtt&&(e=a._options.rtt),a._applyInfo(t,e,n),a._didClose()):a._didClose(1002,"Can't connect to server",!0)}};w.prototype=new t,w.version="0.3.4",w.CONNECTING=0,w.OPEN=1,w.CLOSING=2,w.CLOSED=3,w.prototype._debug=function(){this._options.debug&&f.log.apply(f,arguments)},w.prototype._dispatchOpen=function(){var t=this;t.readyState===w.CONNECTING?(t._transport_tref&&(clearTimeout(t._transport_tref),t._transport_tref=null),t.readyState=w.OPEN,t.dispatchEvent(new s("open"))):t._didClose(1006,"Server lost session")},w.prototype._dispatchMessage=function(t){this.readyState===w.OPEN&&this.dispatchEvent(new s("message",{data:t}))},w.prototype._dispatchHeartbeat=function(t){this.readyState===w.OPEN&&this.dispatchEvent(new s("heartbeat",{}))},w.prototype._didClose=function(t,e,i){var n=this;if(n.readyState!==w.CONNECTING&&n.readyState!==w.OPEN&&n.readyState!==w.CLOSING)throw new Error("INVALID_STATE_ERR");n._ir&&(n._ir.nuke(),n._ir=null),n._transport&&(n._transport.doCleanup(),n._transport=null);var a=new s("close",{code:t,reason:e,wasClean:f.userSetCode(t)});if(!f.userSetCode(t)&&n.readyState===w.CONNECTING&&!i){if(n._try_next_protocol(a))return;a=new s("close",{code:2e3,reason:"All transports failed",wasClean:!1,last_event:a})}n.readyState=w.CLOSED,f.delay(function(){n.dispatchEvent(a)})},w.prototype._didMessage=function(t){var e=this;switch(t.slice(0,1)){case"o":e._dispatchOpen();break;case"a":for(var i=JSON.parse(t.slice(1)||"[]"),n=0;n<i.length;n++)e._dispatchMessage(i[n]);break;case"m":i=JSON.parse(t.slice(1)||"null");e._dispatchMessage(i);break;case"c":i=JSON.parse(t.slice(1)||"[]");e._didClose(i[0],i[1]);break;case"h":e._dispatchHeartbeat()}},w.prototype._try_next_protocol=function(t){var e=this;for(e.protocol&&(e._debug("Closed transport:",e.protocol,""+t),e.protocol=null),e._transport_tref&&(clearTimeout(e._transport_tref),e._transport_tref=null);;){var i=e.protocol=e._protocols.shift();if(!i)return!1;if(w[i]&&!0===w[i].need_body&&(!l.body||void 0!==l.readyState&&"complete"!==l.readyState))return e._protocols.unshift(i),e.protocol="waiting-for-load",f.attachEvent("load",function(){e._try_next_protocol()}),!0;if(w[i]&&w[i].enabled(e._options)){var n=w[i].roundTrips||1,a=(e._options.rto||0)*n||5e3;e._transport_tref=f.delay(a,function(){e.readyState===w.CONNECTING&&e._didClose(2007,"Transport timeouted")});var r=f.random_string(8),o=e._base_url+"/"+e._server+"/"+r;return e._debug("Opening transport:",i," url:"+o," RTO:"+e._options.rto),e._transport=new w[i](e,o,e._base_url),!0}e._debug("Skipping transport:",i)}},w.prototype.close=function(t,e){if(t&&!f.userSetCode(t))throw new Error("INVALID_ACCESS_ERR");return(this.readyState===w.CONNECTING||this.readyState===w.OPEN)&&(this.readyState=w.CLOSING,this._didClose(t||1e3,e||"Normal closure"),!0)},w.prototype.send=function(t){if(this.readyState===w.CONNECTING)throw new Error("INVALID_STATE_ERR");return this.readyState===w.OPEN&&this._transport.doSend(f.quote(""+t)),!0},w.prototype._applyInfo=function(t,e,i){var n=this;n._options.info=t,n._options.rtt=e,n._options.rto=f.countRTO(e),n._options.info.null_origin=!l.domain;var a=f.probeProtocols();n._protocols=f.detectProtocols(a,i,t)};var _=w.websocket=function(t,e){var i=this,n=e+"/websocket";n="https"===n.slice(0,5)?"wss"+n.slice(5):"ws"+n.slice(4),i.ri=t,i.url=n;var a=d.WebSocket||d.MozWebSocket;i.ws=new a(i.url),i.ws.onmessage=function(t){i.ri._didMessage(t.data)},i.unload_ref=f.unload_add(function(){i.ws.close()}),i.ws.onclose=function(){i.ri._didMessage(f.closeFrame(1006,"WebSocket connection broken"))}};_.prototype.doSend=function(t){this.ws.send("["+t+"]")},_.prototype.doCleanup=function(){var t=this,e=t.ws;e&&(e.onmessage=e.onclose=null,e.close(),f.unload_del(t.unload_ref),t.unload_ref=t.ri=t.ws=null)},_.enabled=function(){return!(!d.WebSocket&&!d.MozWebSocket)},_.roundTrips=2;var b=function(){};b.prototype.send_constructor=function(t){this.send_buffer=[],this.sender=t},b.prototype.doSend=function(t){this.send_buffer.push(t),this.send_stop||this.send_schedule()},b.prototype.send_schedule_wait=function(){var t,e=this;e.send_stop=function(){e.send_stop=null,clearTimeout(t)},t=f.delay(25,function(){e.send_stop=null,e.send_schedule()})},b.prototype.send_schedule=function(){var i=this;if(0<i.send_buffer.length){var t="["+i.send_buffer.join(",")+"]";i.send_stop=i.sender(i.trans_url,t,function(t,e){i.send_stop=null,!1===t?i.ri._didClose(1006,"Sending error "+e):i.send_schedule_wait()}),i.send_buffer=[]}},b.prototype.send_destructor=function(){this._send_stop&&this._send_stop(),this._send_stop=null};var C=function(t,e,i){var n=this;if(!("_send_form"in n)){var a=n._send_form=l.createElement("form");(o=n._send_area=l.createElement("textarea")).name="d",a.style.display="none",a.style.position="absolute",a.method="POST",a.enctype="application/x-www-form-urlencoded",a.acceptCharset="UTF-8",a.appendChild(o),l.body.appendChild(a)}a=n._send_form;var r,o=n._send_area,s="a"+f.random_string(8);a.target=s,a.action=t+"/jsonp_send?i="+s;try{r=l.createElement('<iframe name="'+s+'">')}catch(t){(r=l.createElement("iframe")).name=s}r.id=s,a.appendChild(r),r.style.display="none";try{o.value=e}catch(t){f.log("Your browser is seriously broken. Go home! "+t.message)}a.submit();var c=function(t){r.onerror&&(r.onreadystatechange=r.onerror=r.onload=null,f.delay(500,function(){r.parentNode.removeChild(r),r=null}),o.value="",i(!0))};return r.onerror=r.onload=c,r.onreadystatechange=function(t){"complete"==r.readyState&&c()},c},S=function(t,e){var i,n,a=l.createElement("script"),r=function(t){n&&(n.parentNode.removeChild(n),n=null),a&&(clearTimeout(i),a.parentNode.removeChild(a),a.onreadystatechange=a.onerror=a.onload=a.onclick=null,a=null,e(t),e=null)},o=!1,s=null;if(a.id="a"+f.random_string(8),a.src=t,a.type="text/javascript",a.charset="UTF-8",a.onerror=function(t){s||(s=setTimeout(function(){o||r(f.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1e3))},a.onload=function(t){r(f.closeFrame(1006,"JSONP script loaded abnormally (onload)"))},a.onreadystatechange=function(t){if(/loaded|closed/.test(a.readyState)){if(a&&a.htmlFor&&a.onclick){o=!0;try{a.onclick()}catch(t){}}a&&r(f.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}},void 0===a.async&&l.attachEvent)if(/opera/i.test(navigator.userAgent))(n=l.createElement("script")).text="try{var a = document.getElementById('"+a.id+"'); if(a)a.onerror();}catch(x){};",a.async=n.async=!1;else{try{a.htmlFor=a.id,a.event="onclick"}catch(t){}a.async=!0}void 0!==a.async&&(a.async=!0),i=setTimeout(function(){r(f.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35e3);var c=l.getElementsByTagName("head")[0];return c.insertBefore(a,c.firstChild),n&&c.insertBefore(n,c.firstChild),r},k=w["jsonp-polling"]=function(t,e){f.polluteGlobalNamespace();this.ri=t,this.trans_url=e,this.send_constructor(C),this._schedule_recv()};k.prototype=new b,k.prototype._schedule_recv=function(){var e=this;e._recv_stop=A(e.trans_url+"/jsonp",S,function(t){e._recv_stop=null,t&&(e._is_closing||e.ri._didMessage(t)),e._is_closing||e._schedule_recv()})},k.enabled=function(){return!0},k.need_body=!0,k.prototype.doCleanup=function(){var t=this;t._is_closing=!0,t._recv_stop&&t._recv_stop(),t.ri=t._recv_stop=null,t.send_destructor()};var A=function(t,e,i){var n="a"+f.random_string(6),a=t+"?c="+escape("_jp."+n),r=0,o=e(a,function(t){switch(r){case 0:delete d._jp[n],i(t);break;case 1:i(t),r=2;break;case 2:delete d._jp[n]}});d._jp[n]=o;return function(){d._jp[n]&&(r=1,d._jp[n](f.closeFrame(1e3,"JSONP user aborted read")))}},T=function(){};(T.prototype=new b).run=function(t,e,i,n,a){var r;this.ri=t,this.trans_url=e,this.send_constructor((r=a,function(t,e,i){return new r("POST",t+"/xhr_send",e).onfinish=function(t,e){i(200===t||204===t,"http status "+t)},function(t){i(!1,t)}})),this.poll=new z(t,n,e+i,a)},T.prototype.doCleanup=function(){this.poll&&(this.poll.abort(),this.poll=null)};var O=w["xhr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",J,f.XHRCorsObject)};O.prototype=new T,O.enabled=function(){return d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)},O.roundTrips=2,O.need_body=!0;var E=w["xdr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",J,f.XDRObject)};E.prototype=new T,E.enabled=function(){return!!d.XDomainRequest},E.roundTrips=2;var j=w["xhr-polling"]=function(t,e){this.run(t,e,"/xhr",J,f.XHRCorsObject)};j.prototype=new T,j.enabled=O.enabled,j.roundTrips=2;var N=w["xdr-polling"]=function(t,e){this.run(t,e,"/xhr",J,f.XDRObject)};N.prototype=new T,N.enabled=E.enabled,N.roundTrips=2;var R,M=function(){};M.prototype.i_constructor=function(t,e,i){var n=this;n.ri=t,n.origin=f.getOrigin(i),n.base_url=i,n.trans_url=e;var a=i+"/iframe.html";n.ri._options.devel&&(a+="?t="+ +new Date),n.window_id=f.random_string(8),a+="#"+n.window_id,n.iframeObj=f.createIframe(a,function(t){n.ri._didClose(1006,"Unable to load an iframe ("+t+")")}),n.onmessage_cb=f.bind(n.onmessage,n),f.attachMessage(n.onmessage_cb)},M.prototype.doCleanup=function(){var t=this;if(t.iframeObj){f.detachMessage(t.onmessage_cb);try{t.iframeObj.iframe.contentWindow&&t.postMessage("c")}catch(t){}t.iframeObj.cleanup(),t.iframeObj=null,t.onmessage_cb=t.iframeObj=null}},M.prototype.onmessage=function(t){var e=this;if(t.origin===e.origin){var i=t.data.slice(0,8),n=t.data.slice(8,9),a=t.data.slice(9);if(i===e.window_id)switch(n){case"s":e.iframeObj.loaded(),e.postMessage("s",JSON.stringify([w.version,e.protocol,e.trans_url,e.base_url]));break;case"t":e.ri._didMessage(a)}}},M.prototype.postMessage=function(t,e){this.iframeObj.post(this.window_id+t+(e||""),this.origin)},M.prototype.doSend=function(t){this.postMessage("m",t)},M.enabled=function(){var t=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"==typeof d.postMessage||"object"==typeof d.postMessage)&&!t};var U=function(t,e){parent!==d?parent.postMessage(R+t+(e||""),"*"):f.log("Can't postMessage, no parent window.",t,e)},L=function(){};L.prototype._didClose=function(t,e){U("t",f.closeFrame(t,e))},L.prototype._didMessage=function(t){U("t",t)},L.prototype._doSend=function(t){this._transport.doSend(t)},L.prototype._doCleanup=function(){this._transport.doCleanup()},f.parent_origin=void 0,w.bootstrap_iframe=function(){var u;R=l.location.hash.slice(1);f.attachMessage(function(t){if(t.source===parent&&(void 0===f.parent_origin&&(f.parent_origin=t.origin),t.origin===f.parent_origin)){var e=t.data.slice(0,8),i=t.data.slice(8,9),n=t.data.slice(9);if(e===R)switch(i){case"s":var a=JSON.parse(n),r=a[0],o=a[1],s=a[2],c=a[3];if(r!==w.version&&f.log('Incompatibile SockJS! Main site uses: "'+r+'", the iframe: "'+w.version+'".'),!f.flatUrl(s)||!f.flatUrl(c))return void f.log("Only basic urls are supported in SockJS");if(!f.isSameOriginUrl(s)||!f.isSameOriginUrl(c))return void f.log("Can't connect to different domain from within an iframe. ("+JSON.stringify([d.location.href,s,c])+")");(u=new L)._transport=new L[o](u,s,c);break;case"m":u._doSend(n);break;case"c":u&&u._doCleanup(),u=null}}}),U("s")};var D=function(t,e){var i=this;f.delay(function(){i.doXhr(t,e)})};(D.prototype=new e(["finish"])).doXhr=function(t,e){var a=this,r=(new Date).getTime(),i=new e("GET",t+"/info"),o=f.delay(8e3,function(){i.ontimeout()});i.onfinish=function(t,e){if(clearTimeout(o),o=null,200===t){var i=(new Date).getTime()-r,n=JSON.parse(e);"object"!=typeof n&&(n={}),a.emit("finish",n,i)}else a.emit("finish")},i.ontimeout=function(){i.close(),a.emit("finish")}};var P=function(i){var r=this,t=function(){var a=new M;a.protocol="w-iframe-info-receiver";var t=function(t){if("string"==typeof t&&"m"===t.substr(0,1)){var e=JSON.parse(t.substr(1)),i=e[0],n=e[1];r.emit("finish",i,n)}else r.emit("finish");a.doCleanup(),a=null},e={_options:{},_didClose:t,_didMessage:t};a.i_constructor(e,i,i)};l.body?t():f.attachEvent("load",t)};P.prototype=new e(["finish"]);var I=function(){var t=this;f.delay(function(){t.emit("finish",{},2e3)})};I.prototype=new e(["finish"]);var F=function(t){if(f.isSameOriginUrl(t))return new D(t,f.XHRLocalObject);switch(f.isXHRCorsCapable()){case 1:return new D(t,f.XHRLocalObject);case 2:return new D(t,f.XDRObject);case 3:return new P(t);default:return new I}};(L["w-iframe-info-receiver"]=function(i,t,e){new D(e,f.XHRLocalObject).onfinish=function(t,e){i._didMessage("m"+JSON.stringify([t,e])),i._didClose()}}).prototype.doCleanup=function(){};var H=w["iframe-eventsource"]=function(){this.protocol="w-iframe-eventsource",this.i_constructor.apply(this,arguments)};H.prototype=new M,H.enabled=function(){return"EventSource"in d&&M.enabled()},H.need_body=!0,H.roundTrips=3,(L["w-iframe-eventsource"]=function(t,e){this.run(t,e,"/eventsource",B,f.XHRLocalObject)}).prototype=new T;var X=w["iframe-xhr-polling"]=function(){this.protocol="w-iframe-xhr-polling",this.i_constructor.apply(this,arguments)};X.prototype=new M,X.enabled=function(){return d.XMLHttpRequest&&M.enabled()},X.need_body=!0,X.roundTrips=3,(L["w-iframe-xhr-polling"]=function(t,e){this.run(t,e,"/xhr",J,f.XHRLocalObject)}).prototype=new T;var q=w["iframe-htmlfile"]=function(){this.protocol="w-iframe-htmlfile",this.i_constructor.apply(this,arguments)};q.prototype=new M,q.enabled=function(){return M.enabled()},q.need_body=!0,q.roundTrips=3,(L["w-iframe-htmlfile"]=function(t,e){this.run(t,e,"/htmlfile",$,f.XHRLocalObject)}).prototype=new T;var z=function(t,e,i,n){var a=this;a.ri=t,a.Receiver=e,a.recv_url=i,a.AjaxObject=n,a._scheduleRecv()};z.prototype._scheduleRecv=function(){var e=this,i=e.poll=new e.Receiver(e.recv_url,e.AjaxObject);i.onmessage=function(t){1,e.ri._didMessage(t.data)},i.onclose=function(t){e.poll=i=i.onmessage=i.onclose=null,e.poll_is_closing||("permanent"===t.reason?e.ri._didClose(1006,"Polling error ("+t.reason+")"):e._scheduleRecv())}},z.prototype.abort=function(){this.poll_is_closing=!0,this.poll&&this.poll.abort()};var W,B=function(t){var n=this,a=new EventSource(t);a.onmessage=function(t){n.dispatchEvent(new s("message",{data:unescape(t.data)}))},n.es_close=a.onerror=function(t,e){var i=e?"user":2!==a.readyState?"network":"permanent";n.es_close=a.onmessage=a.onerror=null,a.close(),a=null,f.delay(200,function(){n.dispatchEvent(new s("close",{reason:i}))})}};B.prototype=new t,B.prototype.abort=function(){this.es_close&&this.es_close({},!0)};var $=function(t){var i=this;f.polluteGlobalNamespace(),i.id="a"+f.random_string(6,26),t+=(-1===t.indexOf("?")?"?":"&")+"c="+escape("_jp."+i.id);var n,e=function(){if(void 0===W)if("ActiveXObject"in d)try{W=!!new ActiveXObject("htmlfile")}catch(t){}else W=!1;return W}()?f.createHtmlfile:f.createIframe;d._jp[i.id]={start:function(){n.loaded()},message:function(t){i.dispatchEvent(new s("message",{data:t}))},stop:function(){i.iframe_close({},"network")}},i.iframe_close=function(t,e){n.cleanup(),i.iframe_close=n=null,delete d._jp[i.id],i.dispatchEvent(new s("close",{reason:e}))},n=e(t,function(t){i.iframe_close({},"permanent")})};$.prototype=new t,$.prototype.abort=function(){this.iframe_close&&this.iframe_close({},"user")};var J=function(t,e){var r=this,o=0;r.xo=new e("POST",t,null),r.xo.onchunk=function(t,e){if(200===t)for(;;){var i=e.slice(o),n=i.indexOf("\n");if(-1===n)break;o+=n+1;var a=i.slice(0,n);r.dispatchEvent(new s("message",{data:a}))}},r.xo.onfinish=function(t,e){r.xo.onchunk(t,e),r.xo=null;var i=200===t?"network":"permanent";r.dispatchEvent(new s("close",{reason:i}))}};return J.prototype=new t,J.prototype.abort=function(){this.xo&&(this.xo.close(),this.dispatchEvent(new s("close",{reason:"user"})),this.xo=null)},w.getUtils=function(){return f},w.getIframeTransport=function(){return M},w}(),"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1),"function"==typeof define&&define.amd&&define("sockjs",[],function(){return SockJS}),function(){var x,n,h,c,a={}.hasOwnProperty,r=[].slice;x={LF:"\n",NULL:"\0"},h=function(){var o;function y(t,e,i){this.command=t,this.headers=null!=e?e:{},this.body=null!=i?i:""}return y.prototype.toString=function(){var t,e,i,n;for(e in t=[this.command],n=this.headers)a.call(n,e)&&(i=n[e],t.push(e+":"+i));return this.body&&t.push("content-length:"+y.sizeOfUTF8(this.body)),t.push(x.LF+this.body),t.join(x.LF)},y.sizeOfUTF8=function(t){return t?encodeURI(t).match(/%..|./g).length:0},o=function(t){var e,i,n,a,r,o,s,c,u,l,d,f,p,m,v,h,g;for(a=t.search(RegExp(""+x.LF+x.LF)),n=(r=t.substring(0,a).split(x.LF)).shift(),o={},f=function(t){return t.replace(/^\s+|\s+$/g,"")},p=0,v=(h=r.reverse()).length;p<v;p++)c=(l=h[p]).indexOf(":"),o[f(l.substring(0,c))]=f(l.substring(c+1));if(e="",d=a+2,o["content-length"])u=parseInt(o["content-length"]),e=(""+t).substring(d,d+u);else for(i=null,s=m=d,g=t.length;(d<=g?m<g:g<m)&&(i=t.charAt(s))!==x.NULL;s=d<=g?++m:--m)e+=i;return new y(n,o,e)},y.unmarshall=function(a){var r;return function(){var t,e,i,n;for(n=[],t=0,e=(i=a.split(RegExp(""+x.NULL+x.LF+"*"))).length;t<e;t++)0<(null!=(r=i[t])?r.length:void 0)&&n.push(o(r));return n}()},y.marshall=function(t,e,i){return new y(t,e,i).toString()+x.NULL},y}(),n=function(){var v;function t(t){this.ws=t,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16384,this.subscriptions={}}return t.prototype.debug=function(t){var e;return"undefined"!=typeof window&&null!==window&&null!=(e=window.console)?e.log(t):void 0},v=function(){return Date.now?Date.now():(new Date).valueOf},t.prototype._transmit=function(t,e,i){var n;for(n=h.marshall(t,e,i),"function"==typeof this.debug&&this.debug(">>> "+n);;){if(!(n.length>this.maxWebSocketFrameSize))return this.ws.send(n);this.ws.send(n.substring(0,this.maxWebSocketFrameSize)),n=n.substring(this.maxWebSocketFrameSize),"function"==typeof this.debug&&this.debug("remaining = "+n.length)}},t.prototype._setupHeartbeat=function(a){var t,e,i,r,n,o,s=this;if((n=a.version)===c.VERSIONS.V1_1||n===c.VERSIONS.V1_2)return e=(o=function(){var t,e,i,n;for(n=[],t=0,e=(i=a["heart-beat"].split(",")).length;t<e;t++)r=i[t],n.push(parseInt(r));return n}())[0],t=o[1],0!==this.heartbeat.outgoing&&0!==t&&(i=Math.max(this.heartbeat.outgoing,t),"function"==typeof this.debug&&this.debug("send PING every "+i+"ms"),this.pinger=c.setInterval(i,function(){return s.ws.send(x.LF),"function"==typeof s.debug?s.debug(">>> PING"):void 0})),0!==this.heartbeat.incoming&&0!==e?(i=Math.max(this.heartbeat.incoming,e),"function"==typeof this.debug&&this.debug("check PONG every "+i+"ms"),this.ponger=c.setInterval(i,function(){var t;if(t=v()-s.serverActivity,2*i<t)return"function"==typeof s.debug&&s.debug("did not receive server activity for the last "+t+"ms"),s.ws.close()})):void 0},t.prototype._parseConnect=function(){var t,e,i,n;switch(n={},(t=1<=arguments.length?r.call(arguments,0):[]).length){case 2:n=t[0],e=t[1];break;case 3:t[1]instanceof Function?(n=t[0],e=t[1],i=t[2]):(n.login=t[0],n.passcode=t[1],e=t[2]);break;case 4:n.login=t[0],n.passcode=t[1],e=t[2],i=t[3];break;default:n.login=t[0],n.passcode=t[1],e=t[2],i=t[3],n.host=t[4]}return[n,e,i]},t.prototype.connect=function(){var t,p,e,i,m=this;return t=1<=arguments.length?r.call(arguments,0):[],i=this._parseConnect.apply(this,t),e=i[0],this.connectCallback=i[1],p=i[2],"function"==typeof this.debug&&this.debug("Opening Web Socket..."),this.ws.onmessage=function(t){var n,a,e,i,r,o,s,c,u,l,d,f;if(i="undefined"!=typeof ArrayBuffer&&t.data instanceof ArrayBuffer?(n=new Uint8Array(t.data),"function"==typeof m.debug&&m.debug("--- got data length: "+n.length),function(){var t,e,i;for(i=[],t=0,e=n.length;t<e;t++)a=n[t],i.push(String.fromCharCode(a));return i}().join("")):t.data,m.serverActivity=v(),i!==x.LF){for("function"==typeof m.debug&&m.debug("<<< "+i),f=[],u=0,l=(d=h.unmarshall(i)).length;u<l;u++)switch((r=d[u]).command){case"CONNECTED":"function"==typeof m.debug&&m.debug("connected to server "+r.headers.server),m.connected=!0,m._setupHeartbeat(r.headers),f.push("function"==typeof m.connectCallback?m.connectCallback(r):void 0);break;case"MESSAGE":c=r.headers.subscription,(s=m.subscriptions[c]||m.onreceive)?(e=m,o=r.headers["message-id"],r.ack=function(t){return null==t&&(t={}),e.ack(o,c,t)},r.nack=function(t){return null==t&&(t={}),e.nack(o,c,t)},f.push(s(r))):f.push("function"==typeof m.debug?m.debug("Unhandled received MESSAGE: "+r):void 0);break;case"RECEIPT":f.push("function"==typeof m.onreceipt?m.onreceipt(r):void 0);break;case"ERROR":f.push("function"==typeof p?p(r):void 0);break;default:f.push("function"==typeof m.debug?m.debug("Unhandled frame: "+r):void 0)}return f}"function"==typeof m.debug&&m.debug("<<< PONG")},this.ws.onclose=function(){var t;return t="Whoops! Lost connection to "+m.ws.url,"function"==typeof m.debug&&m.debug(t),m._cleanUp(),"function"==typeof p?p(t):void 0},this.ws.onopen=function(){return"function"==typeof m.debug&&m.debug("Web Socket Opened..."),e["accept-version"]=c.VERSIONS.supportedVersions(),e["heart-beat"]=[m.heartbeat.outgoing,m.heartbeat.incoming].join(","),m._transmit("CONNECT",e)}},t.prototype.disconnect=function(t){return this._transmit("DISCONNECT"),this.ws.onclose=null,this.ws.close(),this._cleanUp(),"function"==typeof t?t():void 0},t.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&c.clearInterval(this.pinger),this.ponger)return c.clearInterval(this.ponger)},t.prototype.send=function(t,e,i){return null==e&&(e={}),null==i&&(i=""),e.destination=t,this._transmit("SEND",e,i)},t.prototype.subscribe=function(t,e,i){var n;return null==i&&(i={}),i.id||(i.id="sub-"+this.counter++),i.destination=t,this.subscriptions[i.id]=e,this._transmit("SUBSCRIBE",i),n=this,{id:i.id,unsubscribe:function(){return n.unsubscribe(i.id)}}},t.prototype.unsubscribe=function(t){return delete this.subscriptions[t],this._transmit("UNSUBSCRIBE",{id:t})},t.prototype.begin=function(t){var e,i;return i=t||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:i}),e=this,{id:i,commit:function(){return e.commit(i)},abort:function(){return e.abort(i)}}},t.prototype.commit=function(t){return this._transmit("COMMIT",{transaction:t})},t.prototype.abort=function(t){return this._transmit("ABORT",{transaction:t})},t.prototype.ack=function(t,e,i){return null==i&&(i={}),i["message-id"]=t,i.subscription=e,this._transmit("ACK",i)},t.prototype.nack=function(t,e,i){return null==i&&(i={}),i["message-id"]=t,i.subscription=e,this._transmit("NACK",i)},t}(),c={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(t,e){var i;return null==e&&(e=["v10.stomp","v11.stomp"]),i=new(c.WebSocketClass||WebSocket)(t,e),new n(i)},over:function(t){return new n(t)},Frame:h},"undefined"!=typeof window&&null!==window?(c.setInterval=function(t,e){return window.setInterval(e,t)},c.clearInterval=function(t){return window.clearInterval(t)},window.Stomp=c):"undefined"!=typeof exports&&null!==exports?exports.Stomp=c:self.Stomp=c}.call(this),function(){var t=this,e=t._,o={},a=Array.prototype,i=Object.prototype,n=Function.prototype,r=a.push,s=a.slice,c=a.concat,d=i.toString,u=i.hasOwnProperty,l=a.forEach,f=a.map,p=a.reduce,m=a.reduceRight,v=a.filter,h=a.every,g=a.some,y=a.indexOf,x=a.lastIndexOf,w=Array.isArray,_=Object.keys,b=n.bind,C=function(t){return t instanceof C?t:this instanceof C?void(this._wrapped=t):new C(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):t._=C,C.VERSION="1.6.0";var S=C.each=C.forEach=function(t,e,i){if(null==t)return t;if(l&&t.forEach===l)t.forEach(e,i);else if(t.length===+t.length){for(var n=0,a=t.length;n<a;n++)if(e.call(i,t[n],n,t)===o)return}else{var r=C.keys(t);for(n=0,a=r.length;n<a;n++)if(e.call(i,t[r[n]],r[n],t)===o)return}return t};C.map=C.collect=function(t,n,a){var r=[];return null==t?r:f&&t.map===f?t.map(n,a):(S(t,function(t,e,i){r.push(n.call(a,t,e,i))}),r)};var k="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(t,n,a,r){var o=2<arguments.length;if(null==t&&(t=[]),p&&t.reduce===p)return r&&(n=C.bind(n,r)),o?t.reduce(n,a):t.reduce(n);if(S(t,function(t,e,i){o?a=n.call(r,a,t,e,i):(a=t,o=!0)}),!o)throw new TypeError(k);return a},C.reduceRight=C.foldr=function(n,a,r,o){var s=2<arguments.length;if(null==n&&(n=[]),m&&n.reduceRight===m)return o&&(a=C.bind(a,o)),s?n.reduceRight(a,r):n.reduceRight(a);var c=n.length;if(c!==+c){var u=C.keys(n);c=u.length}if(S(n,function(t,e,i){e=u?u[--c]:--c,s?r=a.call(o,r,n[e],e,i):(r=n[e],s=!0)}),!s)throw new TypeError(k);return r},C.find=C.detect=function(t,n,a){var r;return A(t,function(t,e,i){if(n.call(a,t,e,i))return r=t,!0}),r},C.filter=C.select=function(t,n,a){var r=[];return null==t?r:v&&t.filter===v?t.filter(n,a):(S(t,function(t,e,i){n.call(a,t,e,i)&&r.push(t)}),r)},C.reject=function(t,n,a){return C.filter(t,function(t,e,i){return!n.call(a,t,e,i)},a)},C.every=C.all=function(t,n,a){n||(n=C.identity);var r=!0;return null==t?r:h&&t.every===h?t.every(n,a):(S(t,function(t,e,i){if(!(r=r&&n.call(a,t,e,i)))return o}),!!r)};var A=C.some=C.any=function(t,n,a){n||(n=C.identity);var r=!1;return null==t?r:g&&t.some===g?t.some(n,a):(S(t,function(t,e,i){if(r||(r=n.call(a,t,e,i)))return o}),!!r)};C.contains=C.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):A(t,function(t){return t===e}))},C.invoke=function(t,e){var i=s.call(arguments,2),n=C.isFunction(e);return C.map(t,function(t){return(n?e:t[e]).apply(t,i)})},C.pluck=function(t,e){return C.map(t,C.property(e))},C.where=function(t,e){return C.filter(t,C.matches(e))},C.findWhere=function(t,e){return C.find(t,C.matches(e))},C.max=function(t,a,r){if(!a&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var o=-1/0,s=-1/0;return S(t,function(t,e,i){var n=a?a.call(r,t,e,i):t;s<n&&(o=t,s=n)}),o},C.min=function(t,a,r){if(!a&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var o=1/0,s=1/0;return S(t,function(t,e,i){var n=a?a.call(r,t,e,i):t;n<s&&(o=t,s=n)}),o},C.shuffle=function(t){var e,i=0,n=[];return S(t,function(t){e=C.random(i++),n[i-1]=n[e],n[e]=t}),n},C.sample=function(t,e,i){return null==e||i?(t.length!==+t.length&&(t=C.values(t)),t[C.random(t.length-1)]):C.shuffle(t).slice(0,Math.max(0,e))};var T=function(t){return null==t?C.identity:C.isFunction(t)?t:C.property(t)};C.sortBy=function(t,n,a){return n=T(n),C.pluck(C.map(t,function(t,e,i){return{value:t,index:e,criteria:n.call(a,t,e,i)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(n<i||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var O=function(s){return function(n,a,r){var o={};return a=T(a),S(n,function(t,e){var i=a.call(r,t,e,n);s(o,i,t)}),o}};C.groupBy=O(function(t,e,i){C.has(t,e)?t[e].push(i):t[e]=[i]}),C.indexBy=O(function(t,e,i){t[e]=i}),C.countBy=O(function(t,e){C.has(t,e)?t[e]++:t[e]=1}),C.sortedIndex=function(t,e,i,n){for(var a=(i=T(i)).call(n,e),r=0,o=t.length;r<o;){var s=r+o>>>1;i.call(n,t[s])<a?r=s+1:o=s}return r},C.toArray=function(t){return t?C.isArray(t)?s.call(t):t.length===+t.length?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:t.length===+t.length?t.length:C.keys(t).length},C.first=C.head=C.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:e<0?[]:s.call(t,0,e)},C.initial=function(t,e,i){return s.call(t,0,t.length-(null==e||i?1:e))},C.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},C.rest=C.tail=C.drop=function(t,e,i){return s.call(t,null==e||i?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var E=function(t,e,i){return e&&C.every(t,C.isArray)?c.apply(i,t):(S(t,function(t){C.isArray(t)||C.isArguments(t)?e?r.apply(i,t):E(t,e,i):i.push(t)}),i)};C.flatten=function(t,e){return E(t,e,[])},C.without=function(t){return C.difference(t,s.call(arguments,1))},C.partition=function(t,e,i){e=T(e);var n=[],a=[];return S(t,function(t){(e.call(i,t)?n:a).push(t)}),[n,a]},C.uniq=C.unique=function(i,n,t,e){C.isFunction(n)&&(e=t,t=n,n=!1);var a=t?C.map(i,t,e):i,r=[],o=[];return S(a,function(t,e){(n?e&&o[o.length-1]===t:C.contains(o,t))||(o.push(t),r.push(i[e]))}),r},C.union=function(){return C.uniq(C.flatten(arguments,!0))},C.intersection=function(t){var i=s.call(arguments,1);return C.filter(C.uniq(t),function(e){return C.every(i,function(t){return C.contains(t,e)})})},C.difference=function(t){var e=c.apply(a,s.call(arguments,1));return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){for(var t=C.max(C.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;i<t;i++)e[i]=C.pluck(arguments,""+i);return e},C.object=function(t,e){if(null==t)return{};for(var i={},n=0,a=t.length;n<a;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},C.indexOf=function(t,e,i){if(null==t)return-1;var n=0,a=t.length;if(i){if("number"!=typeof i)return t[n=C.sortedIndex(t,e)]===e?n:-1;n=i<0?Math.max(0,a+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;n<a;n++)if(t[n]===e)return n;return-1},C.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(x&&t.lastIndexOf===x)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var a=n?i:t.length;a--;)if(t[a]===e)return a;return-1},C.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),a=0,r=new Array(n);a<n;)r[a++]=t,t+=i;return r};var j=function(){};C.bind=function(i,n){var a,r;if(b&&i.bind===b)return b.apply(i,s.call(arguments,1));if(!C.isFunction(i))throw new TypeError;return a=s.call(arguments,2),r=function(){if(!(this instanceof r))return i.apply(n,a.concat(s.call(arguments)));j.prototype=i.prototype;var t=new j;j.prototype=null;var e=i.apply(t,a.concat(s.call(arguments)));return Object(e)===e?e:t}},C.partial=function(a){var r=s.call(arguments,1);return function(){for(var t=0,e=r.slice(),i=0,n=e.length;i<n;i++)e[i]===C&&(e[i]=arguments[t++]);for(;t<arguments.length;)e.push(arguments[t++]);return a.apply(this,e)}},C.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return S(t,function(t){e[t]=C.bind(e[t],e)}),e},C.memoize=function(e,i){var n={};return i||(i=C.identity),function(){var t=i.apply(this,arguments);return C.has(n,t)?n[t]:n[t]=e.apply(this,arguments)}},C.delay=function(t,e){var i=s.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},C.defer=function(t){return C.delay.apply(C,[t,1].concat(s.call(arguments,1)))},C.throttle=function(i,n,a){var r,o,s,c=null,u=0;a||(a={});var l=function(){u=!1===a.leading?0:C.now(),c=null,s=i.apply(r,o),r=o=null};return function(){var t=C.now();u||!1!==a.leading||(u=t);var e=n-(t-u);return r=this,o=arguments,e<=0?(clearTimeout(c),c=null,u=t,s=i.apply(r,o),r=o=null):c||!1===a.trailing||(c=setTimeout(l,e)),s}},C.debounce=function(e,i,n){var a,r,o,s,c,u=function(){var t=C.now()-s;t<i?a=setTimeout(u,i-t):(a=null,n||(c=e.apply(o,r),o=r=null))};return function(){o=this,r=arguments,s=C.now();var t=n&&!a;return a||(a=setTimeout(u,i)),t&&(c=e.apply(o,r),o=r=null),c}},C.once=function(t){var e,i=!1;return function(){return i||(i=!0,e=t.apply(this,arguments),t=null),e}},C.wrap=function(t,e){return C.partial(e,t)},C.compose=function(){var i=arguments;return function(){for(var t=arguments,e=i.length-1;0<=e;e--)t=[i[e].apply(this,t)];return t[0]}},C.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},C.keys=function(t){if(!C.isObject(t))return[];if(_)return _(t);var e=[];for(var i in t)C.has(t,i)&&e.push(i);return e},C.values=function(t){for(var e=C.keys(t),i=e.length,n=new Array(i),a=0;a<i;a++)n[a]=t[e[a]];return n},C.pairs=function(t){for(var e=C.keys(t),i=e.length,n=new Array(i),a=0;a<i;a++)n[a]=[e[a],t[e[a]]];return n},C.invert=function(t){for(var e={},i=C.keys(t),n=0,a=i.length;n<a;n++)e[t[i[n]]]=i[n];return e},C.functions=C.methods=function(t){var e=[];for(var i in t)C.isFunction(t[i])&&e.push(i);return e.sort()},C.extend=function(i){return S(s.call(arguments,1),function(t){if(t)for(var e in t)i[e]=t[e]}),i},C.pick=function(e){var i={},t=c.apply(a,s.call(arguments,1));return S(t,function(t){t in e&&(i[t]=e[t])}),i},C.omit=function(t){var e={},i=c.apply(a,s.call(arguments,1));for(var n in t)C.contains(i,n)||(e[n]=t[n]);return e},C.defaults=function(i){return S(s.call(arguments,1),function(t){if(t)for(var e in t)void 0===i[e]&&(i[e]=t[e])}),i},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t};var N=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var a=d.call(t);if(a!=d.call(e))return!1;switch(a){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=i.length;r--;)if(i[r]==t)return n[r]==e;var o=t.constructor,s=e.constructor;if(o!==s&&!(C.isFunction(o)&&o instanceof o&&C.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1;i.push(t),n.push(e);var c=0,u=!0;if("[object Array]"==a){if(u=(c=t.length)==e.length)for(;c--&&(u=N(t[c],e[c],i,n)););}else{for(var l in t)if(C.has(t,l)&&(c++,!(u=C.has(e,l)&&N(t[l],e[l],i,n))))break;if(u){for(l in e)if(C.has(e,l)&&!c--)break;u=!c}}return i.pop(),n.pop(),u};C.isEqual=function(t,e){return N(t,e,[],[])},C.isEmpty=function(t){if(null==t)return!0;if(C.isArray(t)||C.isString(t))return 0===t.length;for(var e in t)if(C.has(t,e))return!1;return!0},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=w||function(t){return"[object Array]"==d.call(t)},C.isObject=function(t){return t===Object(t)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){C["is"+e]=function(t){return d.call(t)=="[object "+e+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return!(!t||!C.has(t,"callee"))}),"function"!=typeof/./&&(C.isFunction=function(t){return"function"==typeof t}),C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!=+t},C.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==d.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return u.call(t,e)},C.noConflict=function(){return t._=e,this},C.identity=function(t){return t},C.constant=function(t){return function(){return t}},C.property=function(e){return function(t){return t[e]}},C.matches=function(i){return function(t){if(t===i)return!0;for(var e in i)if(i[e]!==t[e])return!1;return!0}},C.times=function(t,e,i){for(var n=Array(Math.max(0,t)),a=0;a<t;a++)n[a]=e.call(i,a);return n},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},C.now=Date.now||function(){return(new Date).getTime()};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=C.invert(R.escape);var M={escape:new RegExp("["+C.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+C.keys(R.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(e){C[e]=function(t){return null==t?"":(""+t).replace(M[e],function(t){return R[e][t]})}}),C.result=function(t,e){if(null!=t){var i=t[e];return C.isFunction(i)?i.call(t):i}},C.mixin=function(i){S(C.functions(i),function(t){var e=C[t]=i[t];C.prototype[t]=function(){var t=[this._wrapped];return r.apply(t,arguments),I.call(this,e.apply(C,t))}})};var U=0;C.uniqueId=function(t){var e=++U+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(r,t,e){var i;e=C.defaults({},e,C.templateSettings);var n=new RegExp([(e.escape||L).source,(e.interpolate||L).source,(e.evaluate||L).source].join("|")+"|$","g"),o=0,s="__p+='";r.replace(n,function(t,e,i,n,a){return s+=r.slice(o,a).replace(P,function(t){return"\\"+D[t]}),e&&(s+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),n&&(s+="';\n"+n+"\n__p+='"),o=a+t.length,t}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}if(t)return i(t,C);var a=function(t){return i.call(this,t,C)};return a.source="function("+(e.variable||"obj")+"){\n"+s+"}",a},C.chain=function(t){return C(t).chain()};var I=function(t){return this._chain?C(t).chain():t};C.mixin(C),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var i=a[e];C.prototype[e]=function(){var t=this._wrapped;return i.apply(t,arguments),"shift"!=e&&"splice"!=e||0!==t.length||delete t[0],I.call(this,t)}}),S(["concat","join","slice"],function(t){var e=a[t];C.prototype[t]=function(){return I.call(this,e.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return C})}.call(this),function(){var o,t=this;if("function"==typeof t.require)try{var e=t.require("crypto").randomBytes;o=e&&function(){return e(16)}}catch(t){}if(!o&&t.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);o=function(){return crypto.getRandomValues(i),i}}if(!o){var n=new Array(16);o=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),n[e]=t>>>((3&e)<<3)&255;return n}}for(var s="function"==typeof t.Buffer?t.Buffer:Array,a=[],r={},c=0;c<256;c++)a[c]=(c+256).toString(16).substr(1),r[a[c]]=c;function p(t,e){var i=e||0,n=a;return n[t[i++]]+n[t[i++]]+n[t[i++]]+n[t[i++]]+"-"+n[t[i++]]+n[t[i++]]+"-"+n[t[i++]]+n[t[i++]]+"-"+n[t[i++]]+n[t[i++]]+"-"+n[t[i++]]+n[t[i++]]+n[t[i++]]+n[t[i++]]+n[t[i++]]+n[t[i++]]}var u=o(),m=[1|u[0],u[1],u[2],u[3],u[4],u[5]],v=16383&(u[6]<<8|u[7]),h=0,g=0;function l(t,e,i){var n=e&&i||0;"string"==typeof t&&(e="binary"==t?new s(16):null,t=null);var a=(t=t||{}).random||(t.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var r=0;r<16;r++)e[n+r]=a[r];return e||p(a)}if((uuid=l).v1=function(t,e,i){var n=e&&i||0,a=e||[],r=null!=(t=t||{}).clockseq?t.clockseq:v,o=null!=t.msecs?t.msecs:(new Date).getTime(),s=null!=t.nsecs?t.nsecs:g+1,c=o-h+(s-g)/1e4;if(c<0&&null==t.clockseq&&(r=r+1&16383),(c<0||h<o)&&null==t.nsecs&&(s=0),1e4<=s)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=o,v=r;var u=(1e4*(268435455&(o+=122192928e5))+(g=s))%4294967296;a[n++]=u>>>24&255,a[n++]=u>>>16&255,a[n++]=u>>>8&255,a[n++]=255&u;var l=o/4294967296*1e4&268435455;a[n++]=l>>>8&255,a[n++]=255&l,a[n++]=l>>>24&15|16,a[n++]=l>>>16&255,a[n++]=r>>>8|128,a[n++]=255&r;for(var d=t.node||m,f=0;f<6;f++)a[n+f]=d[f];return e||p(a)},uuid.v4=l,uuid.parse=function(t,e,i){var n=e&&i||0,a=0;for(e=e||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){a<16&&(e[n+a++]=r[t])});a<16;)e[n+a++]=0;return e},uuid.unparse=p,uuid.BufferClass=s,"function"==typeof define&&define.amd)define("uuid",[],function(){return uuid});else if("undefined"!=typeof module&&module.exports)module.exports=uuid;else{var d=t.uuid;uuid.noConflict=function(){return t.uuid=d,uuid},t.uuid=uuid}}.call(this),function(a,d){"use strict";var f="function",p="undefined",m="object",t="major",e="model",i="name",n="type",r="vendor",o="version",s="architecture",c="console",u="mobile",l="tablet",v="smarttv",h={extend:function(t,e){for(var i in e)-1!=="browser cpu device engine os".indexOf(i)&&e[i].length%2==0&&(t[i]=e[i].concat(t[i]));return t},has:function(t,e){if("string"==typeof t)return-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()}},g={rgx:function(){for(var t,e,i,n,a,r,o,s=0,c=arguments;s<c.length;s+=2){var u=c[s],l=c[s+1];if(typeof t===p)for(n in t={},l)typeof(a=l[n])===m?t[a[0]]=d:t[a]=d;for(e=i=0;e<u.length;e++)if(r=u[e].exec(this.getUA())){for(n=0;n<l.length;n++)o=r[++i],typeof(a=l[n])===m&&0<a.length?2==a.length?typeof a[1]==f?t[a[0]]=a[1].call(this,o):t[a[0]]=a[1]:3==a.length?typeof a[1]!==f||a[1].exec&&a[1].test?t[a[0]]=o?o.replace(a[1],a[2]):d:t[a[0]]=o?a[1].call(this,o,a[2]):d:4==a.length&&(t[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):d):t[a]=o||d;break}if(r)break}return t},str:function(t,e){for(var i in e)if(typeof e[i]===m&&0<e[i].length){for(var n=0;n<e[i].length;n++)if(h.has(e[i][n],t))return"?"===i?d:i}else if(h.has(e[i],t))return"?"===i?d:i;return t}},y={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},x={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[i,o,t],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[i,"Opera"],o,t],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[i,o,t],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[i,"IE"],o,t],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[i,"Yandex"],o,t],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[i,/_/g," "],o,t],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i],[i,o,t],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[i,"Dolphin"],o,t],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[i,"Chrome"],o,t],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[o,t,[i,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[o,t,i],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[i,[t,g.str,y.browser.oldsafari.major],[o,g.str,y.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[i,o,t],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[i,"Netscape"],o,t],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[i,o,t]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[s,"amd64"]],[/(ia32(?=;))/i],[[s,h.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[s,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[s,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[s,/ower/,"",h.lowerize]],[/(sun4\w)[;\)]/i],[[s,"sparc"]],[/(ia64(?=;)|68k(?=\))|arm(?=v\d+;)|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[s,h.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[e,r,[n,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[e,[r,"Apple"],[n,l]],[/(apple\s{0,1}tv)/i],[[e,"Apple TV"],[r,"Apple"]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[r,e,[n,l]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[e,[r,"Amazon"],[n,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[e,g.str,y.device.amazon.model],[r,"Amazon"],[n,u]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[e,r,[n,u]],[/\((ip[honed|\s\w*]+);/i],[e,[r,"Apple"],[n,u]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[r,e,[n,u]],[/\((bb10);\s(\w+)/i],[[r,"BlackBerry"],e,[n,u]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7))/i],[[r,"Asus"],e,[n,l]],[/(sony)\s(tablet\s[ps])/i],[r,e,[n,l]],[/(nintendo)\s([wids3u]+)/i],[r,e,[n,c]],[/((playstation)\s[3portablevi]+)/i],[[r,"Sony"],e,[n,c]],[/(sprint\s(\w+))/i],[[r,g.str,y.device.sprint.vendor],[e,g.str,y.device.sprint.model],[n,u]],[/(Lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[[r,"Lenovo"],e,[n,l]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[r,[e,/_/g," "],[n,u]],[/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i,/(mot)[\s-]?(\w+)*/i],[[r,"Motorola"],e,[n,u]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[[r,"Motorola"],e,[n,l]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[r,"Samsung"],e,[n,l]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[r,"Samsung"],e,[n,u]],[/(sie)-(\w+)*/i],[[r,"Siemens"],e,[n,u]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[r,"Nokia"],e,[n,u]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[[r,"Acer"],e,[n,l]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[[r,"LG"],e,[n,l]],[/(lg) netcast\.tv/i],[r,[n,v]],[/((nexus\s[45]))/i,/(lg)[e;\s\/-]+(\w+)*/i],[[r,"LG"],e,[n,u]],[/android.+((ideatab[a-z0-9\-\s]+))/i],[[r,"Lenovo"],e,[n,l]],[/linux;.+((jolla));/i],[r,e,[n,u]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[n,h.lowerize],r,e]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,o],[/rv\:([\w\.]+).*(gecko)/i],[o,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,o],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[o,g.str,y.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[o,g.str,y.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],o],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,o],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],o],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],o],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,o],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],o],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],o],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,o],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[o,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[i,[o,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[i,o]]},w=function(t,e){if(!(this instanceof w))return new w(t,e).getResult();var i=t||(a&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:""),n=e?h.extend(x,e):x;this.getBrowser=function(){return g.rgx.apply(this,n.browser)},this.getCPU=function(){return g.rgx.apply(this,n.cpu)},this.getDevice=function(){return g.rgx.apply(this,n.device)},this.getEngine=function(){return g.rgx.apply(this,n.engine)},this.getOS=function(){return g.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(t){return i=t,this},this.setUA(i)};if(w.VERSION="0.7.1",w.BROWSER={NAME:i,MAJOR:t,VERSION:o},w.CPU={ARCHITECTURE:s},w.DEVICE={MODEL:e,VENDOR:r,TYPE:n,CONSOLE:c,MOBILE:u,SMARTTV:v,TABLET:l},w.ENGINE={NAME:i,VERSION:o},w.OS={NAME:i,VERSION:o},typeof exports!==p)typeof module!==p&&module.exports&&(exports=module.exports=w),exports.UAParser=w;else{a.UAParser=w,typeof define===f&&define.amd&&define("UAParser",[],function(){return w});var _=a.jQuery||a.Zepto;if(typeof _!==p){var b=new w;_.ua=b.getResult(),_.ua.get=function(){return b.getUA()},_.ua.set=function(t){b.setUA(t);var e=b.getResult();for(var i in e)_.ua[i]=e[i]}}}}(this);var max=max||{};!function(r){max.views=max.views||{},r.extend(max.views,function(){function t(t){var i=this;i.minchars=t.minchars,i.maxui=t.maxui,i.source=t.source,i.action=t.action,i.filter=t.filter,i.requests={},i.$el=r(t.list),i.$list=i.$el.find("ul"),i.$el.on("click",".maxui-prediction",function(t){var e=r(t.currentTarget);i.select(e),i.choose(t)})}function e(t){var e=this;e.input=t.input,e.$input=r(e.input),e.placeholder=t.placeholder,e.$delegate=r(t.delegate),e.setBindings(),e.bindings=t.bindings,e.$input.val(e.placeholder)}return t.prototype.select=function(t){this.$list.find(".maxui-prediction.selected").removeClass("selected"),t.addClass("selected")},t.prototype.choose=function(t){var e=this.$list.find(".maxui-prediction.selected");this.action.apply(this,[e]),this.hide()},t.prototype.moveup=function(t){var e=this.$list.find(".maxui-prediction.selected"),i=e.prev();0<i.length?this.select(i):this.select(e.siblings(":last"))},t.prototype.movedown=function(t){var e=this.$list.find(".maxui-prediction.selected"),i=e.next();e.removeClass("selected"),0<i.length?this.select(i):this.select(e.siblings(":first"))},t.prototype.matchingRequest=function(t){var i,n=t.substr(0,t.length-1);if(r.each(this.requests,function(t,e){n===t&&(i=e)}),i&&!i.remaining)return i.text},t.prototype.normalizeWhiteSpace=function(t,e){t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/\n /,"\n");var i=!0;return 1<arguments.length&&(i=e),!0===i&&(t=t.replace(/[ ]{2,}/gi," ")),t},t.prototype.show=function(t){var e=this,i=r(t.target),n=e.normalizeWhiteSpace(i.val(),!1);if(n.length>=this.minchars){var a=e.matchingRequest(n);e.requests.hasOwnProperty(n)?e.render(n,n):a?e.render(n,a):this.source.apply(this,[t,n,function(t){e.requests[n]={text:n,data:t,remaining:this.getResponseHeader("X-Has-Remaining-Items")},e.render(n,n)}])}else e.hide()},t.prototype.render=function(t,e){for(var i=this,n="",a=i.requests[e].data,r=i.filter(),o=!1,s=0;s<a.length;s++){var c=a[s],u=0<=c.username.search(new RegExp(t,"i")),l=0<=c.displayName.search(new RegExp(t,"i"))||u;if(-1===r.indexOf(c.username)&&l){var d=i.maxui.settings.avatarURLpattern.format(c.username),f={username:c.username,displayName:c.displayName,avatarURL:d,cssclass:"maxui-prediction"+(o?"":" selected")};n+=i.maxui.templates.predictive.render(f),o=!0}}""===n&&(n="<li>"+i.maxui.settings.literals.no_match_found+"</li>"),i.$list.html(n),i.$el.show()},t.prototype.hide=function(t){this.$el.hide()},e.prototype.normalizeWhiteSpace=function(t,e){t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/\n /,"\n");var i=!0;return 1<arguments.length&&(i=e),!0===i&&(t=t.replace(/[ ]{2,}/gi," ")),t},e.prototype.bind=function(t,e){this.$delegate.on(t,this.input,e)},e.prototype.execExtraBinding=function(t,e){this.bindings.hasOwnProperty(e.type)&&this.bindings[e.type].apply(t,[e])},e.prototype.getInputValue=function(){var t=this.$input.val();return this.normalizeWhiteSpace(t,!1)},e.prototype.setBindings=function(){var e=this;e.bind("focusin",function(t){t.preventDefault(),t.stopPropagation(),e.getInputValue()===e.placeholder&&r(this).val(""),e.execExtraBinding(this,t)}),e.bind("focusout",function(t){t.preventDefault(),t.stopPropagation(),""===e.getInputValue()&&(r(this).val(e.placeholder),e.$input.toggleClass("maxui-empty",!0)),e.execExtraBinding(this,t)}),e.bind("maxui-input-submit maxui-input-cancel maxui-input-up maxui-input-down maxui-input-keypress",function(t){t.preventDefault(),t.stopPropagation(),e.execExtraBinding(this,t)}),e.bind("maxui-input-clear",function(t){e.$input.val(e.placeholder)}),e.bind("keydown",function(t){38===t.which?e.$input.trigger("maxui-input-up",[t]):40===t.which&&e.$input.trigger("maxui-input-down",[t]),e.$input.toggleClass("maxui-empty",!1)}),e.bind("keyup",function(t){t.preventDefault(),t.stopPropagation(),13!==t.which||t.shiftKey?27===t.which?e.$input.trigger("maxui-input-cancel",[t]):38!==t.which&&40!==t.which&&e.$input.trigger("maxui-input-keypress",[t]):e.$input.trigger("maxui-input-submit",[t]),e.execExtraBinding(this,t)})},{MaxInput:e,MaxPredictive:t}}())}(jQuery);var max=max||{};!function(i){max.views=max.views||{},i.extend(max.views,function(){function t(t){var e=this;e.maxui=t,e.title="Overlay Title",e.content="",e.el="#maxui-overlay-panel",e.overlay_show_class=".maxui-overlay",i(e.el+" .maxui-close").click(function(t){t.preventDefault(),t.stopPropagation(),e.maxui.overlay.hide()})}return t.prototype.$el=function(){return i(this.el)},t.prototype.setTitle=function(t){this.$el().find("#maxui-overlay-title").text(t)},t.prototype.setContent=function(t){this.$el().find("#maxui-overlay-content").html(t)},t.prototype.configure=function(t){this.setTitle(t.title),this.setContent(t.content),t.bind(this)},t.prototype.show=function(t){var e=this;t.load(function(t){e.configure(t)}),i(e.overlay_show_class).show(),e.$el().animate({opacity:1},200)},t.prototype.hide=function(){var e=this;e.$el().trigger("maxui-overlay-close",[]),e.$el().animate({opacity:0},200,function(t){i(e.overlay_show_class).hide()})},{MaxOverlay:t}}())}(jQuery);var max=max||{};!function(n){max.views=max.views||{},n.extend(max.views,function(){function t(t){var e=this;e.maxui=t.maxui,e.width=t.width,e.handle=t.handle,e.dragging=!1,e.scrollbar_selector=t.scrollbar,e.$bar=n(e.scrollbar_selector),e.$dragger=e.$bar.find(".maxui-dragger"),e.target_selector=t.target,e.$target=n(e.target_selector),e.bind()}return t.prototype.bind=function(){var s=this;s.$target.on("mousewheel",function(t,e,i,n){if(t.preventDefault(),t.stopPropagation(),s.enabled()){var a=s.$target.height()-s.maxtop-s.handle.height,r=parseInt(s.$target.css("margin-top"),10)+1*n*10;0<r&&(r=0),r<-1*a&&(r=-1*a),s.$target.css({"margin-top":r});var o=100*(r*=-1)/a;s.setDraggerPosition(o)}}),n(document).on("mousemove",function(t){if(s.dragging&&(t.stopPropagation(),t.preventDefault(),s.enabled())){var e=t.clientY+n(window).scrollTop()-s.$bar.offset().top;e<0&&(e=0),e>=s.maxtop&&(e=s.maxtop);var i=100*e/s.maxtop;s.setContentPosition(i)}}),n(document.body).on("mousedown",".maxui-dragger",function(t){t.stopPropagation(),t.preventDefault(),s.dragging=!0}),n(document).on("mouseup",function(t){s.dragging=!1})},t.prototype.setHeight=function(t){var e=n("#maxui-conversations .maxui-wrapper").offset().top-this.maxui.offset().top-1;this.$bar.css({height:t,top:e}),this.maxtop=t-this.handle.height-2},t.prototype.setTarget=function(t){this.$target=n(t)},t.prototype.setDraggerPosition=function(t){var e=this.maxtop*t/100;this.$dragger.css({"margin-top":e})},t.prototype.setContentPosition=function(t){var e=this;if(e.enabled()){var i=(e.$target.height()-e.maxtop-e.handle.height)*t/100;e.$target.css({"margin-top":-1*i}),e.setDraggerPosition(t)}else e.$target.css({"margin-top":""}),e.setDraggerPosition(0)},t.prototype.enabled=function(){return this.$target.height()>this.maxtop},{MaxScrollbar:t}}())}(jQuery);var max=max||{};max.templates=function(){return{activity:Hogan.compile('<div class="maxui-activity {{#flagged}}maxui-flagged{{/flagged}}" id="{{id}}" userid="{{actor.id}}" username="{{actor.username}}">            <div class="maxui-activity-content">                <div class="maxui-topright">                    {{^showLikesCount}}<span class="maxui-publisheddate">{{date}}</span>{{/showLikesCount}}                    {{#showLikesCount}}<span class="maxui-likescount"><strong>{{likes}}</strong><i class="maxui-icon-thumbs-up"></i></span>{{/showLikesCount}}                </div>                <div class="maxui-actor">                      <a href="#"><span class="maxui-avatar maxui-big"><img src="{{avatarURL}}"></span>                          <span class="maxui-displayname">{{actor.displayName}}</span></a>                  <span class="maxui-username">{{actor.username}}&nbsp;</span>                </div>                <div class="maxui-activity-message">                    {{#fileDownload}}                    <form action="/activities/{{id}}/file/download" method="POST">                        <input type="hidden" name="X-Oauth-Token" value="{{auth.token}}">                        <input type="hidden" name="X-Oauth-Username" value="{{auth.username}}">                        <input type="hidden" name="X-Oauth-Scope" value="widgetcli">                        <input type="hidden" name="X-HTTP-Method-Override" value="GET">                        <span class="maxui-icon-download"></span><input type="submit" class="maxui-download" name="submit" value="{{filename}}">                    </form>                    {{/fileDownload}}                    <p class="maxui-body">{{&text}}</p>                        </div>            </div>            <div class="maxui-footer">                {{#publishedIn}}                <div class="maxui-origin maxui-icon-">                       {{literals.context_published_in}}                       <a href="{{publishedIn.url}}">{{publishedIn.displayName}}</a>                       {{#via}}                           {{literals.generator_via}}                           <span class="maxui-via">                           {{via}}                           </span>                       {{/via}}                </div>                {{/publishedIn}}                <div class="maxui-actions">                    <a href="" class="maxui-action maxui-commentaction maxui-icon- {{#replies}}maxui-has-comments{{/replies}}"><strong>{{replies.length}}</strong> {{literals.toggle_comments}}</a>                    <a href="" class="maxui-action maxui-favorites {{#favorited}}maxui-favorited{{/favorited}} maxui-icon-">{{literals.favorite}}</a>                    <a href="" class="maxui-action maxui-likes {{#liked}}maxui-liked{{/liked}} maxui-icon-"><strong>{{likes}}</strong> {{literals.like}}</a>                    {{#canFlagActivity}}                    <a href="" class="maxui-action maxui-flag {{#flagged}}maxui-flagged{{/flagged}} maxui-icon-">{{literals.flag_activity_icon}}</a>                    {{/canFlagActivity}}                    {{#canDeleteActivity}}                    <a href="" class="maxui-action maxui-delete maxui-icon-">{{literals.delete_activity_icon}}</a>                    <div class="maxui-popover left">                        <div class="maxui-arrow"></div>                            <h3 class="maxui-popover-title">{{literals.delete_activity_confirmation}}</h3>                            <div class="maxui-popover-content">                              <input type="button" class="maxui-button-delete" value="{{literals.delete_activity_delete}}">                              <input type="button" class="maxui-button-cancel" value="{{literals.delete_activity_cancel}}">                            </div>                    </div>                    {{/canDeleteActivity}}                        </div>            </div>                    {{#canViewComments}}            <div class="maxui-comments" style="display: none">                <div class="maxui-commentsbox">                    {{#replies}}                        {{> comment}}                    {{/replies}}                </div>                {{#canWriteComment}}                <div class="maxui-newcommentbox">                        <textarea class="maxui-empty maxui-text-input" id="maxui-commentBox" data-literal="{{literals.new_comment_text}}">{{literals.new_comment_text}}</textarea>                        <input disabled="disabled" type="button" class="maxui-button maxui-disabled" value="{{literals.new_comment_post}}"/>                </div>                {{/canWriteComment}}            </div>            {{/canViewComments}}                    <div class="maxui-clear"></div>        </div>            '),comment:Hogan.compile('<div class="maxui-comment" id="{{id}}" userid="{{actor.id}}" displayname="{{actor.username}}">            <div class="maxui-activity-content">               <span class="maxui-publisheddate">{{date}}</span>               <div class="maxui-actor">                   <a href="#">                       <span class="maxui-avatar maxui-little"><img src="{{avatarURL}}"></span>                       <span class="maxui-displayname">{{actor.displayName}}</span></a>                     <span class="maxui-username">{{actor.username}}</span>               </div>               <div>                   <p class="maxui-body">{{&text}}</p>                   {{#canDeleteComment}}                   <span class="maxui-delete-comment maxui-icon-"></span>                   <div class="maxui-popover left">                        <div class="maxui-arrow"></div>                            <h3 class="maxui-popover-title">{{literals.delete_activity_confirmation}}</h3>                            <div class="maxui-popover-content">                              <input type="button" class="maxui-button-delete" value="{{literals.delete_activity_delete}}">                              <input type="button" class="maxui-button-cancel" value="{{literals.delete_activity_cancel}}">                            </div>                   </div>                   {{/canDeleteComment}}               </div>            </div>        </div>            '),postBox:Hogan.compile('      <span class="maxui-avatar maxui-big">                  <img src="{{avatar}}">              </span>              <div id="maxui-newactivity-box">                   <div class="maxui-wrapper">                       <textarea class="maxui-empty maxui-text-input" data-literal="{{textLiteral}}">{{textLiteral}}</textarea>                       <div class="maxui-error-box"></div>                   </div>                            {{#showSubscriptionList}}                    <select id="maxui-subscriptions">                      {{#subscriptionList}}                        <option value="{{hash}}">{{displayname}}</option>                      {{/subscriptionList}}                    </select>                    {{/showSubscriptionList}}                   <input disabled="disabled" type="button" class="maxui-button maxui-disabled" value="{{buttonLiteral}}">              </div>            '),predictive:Hogan.compile('<li data-username="{{username}}" data-displayname="{{displayName}}" class="{{cssclass}}">        <img src="{{avatarURL}}"/><span>{{displayName}}</span>        </li>            '),filters:Hogan.compile('{{#filters}}            {{#visible}}            <div class="maxui-filter maxui-{{type}}" type="{{type}}" value="{{value}}"><span>{{prepend}}{{value}}<a class="maxui-close" href=""><i class="maxui-icon-cancel-circled" alt="tanca"/></a></span></div>            {{/visible}}        {{/filters}}            '),message:Hogan.compile('<div class="maxui-message maxui-user-{{#othersMessage}}not{{/othersMessage}}me" id="{{id}}">            <div class="maxui-activity-content">                <span class="maxui-avatar maxui-little"><img src="{{avatarURL}}"></span>                <div class="maxui-balloon">                    {{#fileDownload}}                    <form action="/messages/{{id}}/file/download" method="POST">                        <input type="hidden" name="X-Oauth-Token" value="{{auth.token}}">                        <input type="hidden" name="X-Oauth-Username" value="{{auth.username}}">                        <input type="hidden" name="X-Oauth-Scope" value="widgetcli">                        <input type="hidden" name="X-HTTP-Method-Override" value="GET">                        <span class="maxui-icon-download"></span><input type="submit" class="maxui-download" name="submit" value="File download">                    </form>                    {{/fileDownload}}                    {{#showDisplayName}}<span class="maxui-displayname">{{displayName}}</span>{{/showDisplayName}}                    <p class="maxui-body">{{&text}}</p>                    <span class="maxui-publisheddate">{{date}}</span>                    <i class="maxui-icon-check{{#ack}} maxui-ack{{/ack}}"></i>                </div>            </div>            <div class="maxui-clear"></div>        </div>            '),mainUIActivity:Hogan.compile('<div id="maxui-container">        {{#username}}         <div id="maxui-mainpanel">                   <div id="maxui-newactivity" {{#hidePostbox}}style="display:none;"{{/hidePostbox}}>           </div>                   <div id="maxui-search" class="folded">               <a id="maxui-search-toggle" class="maxui-disabled maxui-icon-" href="#" alt="obre-tanca"></a>               <a href="#" id="maxui-favorites-filter" title="{{literals.favorites_filter_hint}}"><i class="maxui-icon-star"/></a>               <div id="maxui-search-box">                  <input id="maxui-search-text" type="search" data-literal="{{literals.search_text}}" class="maxui-empty maxui-text-input" value="{{literals.search_text}}" />               </div>               <div id="maxui-search-filters"></div>           </div>                   <div id="maxui-show-timeline" class="maxui-togglebar maxui-icon-" style="{{showTimelineToggle}}"><a href="#">{{literals.activity}}</a></div>                      <div id="maxui-activity-sort">                <a class="maxui-sort-action maxui-most-recent {{orderViewRecent}}" href="#">{{literals.recent_activity}}</a>                /                <a class="maxui-sort-action maxui-most-valued {{orderViewLikes}}" href="#">{{literals.valued_activity}}</a>                /                <a class="maxui-sort-action maxui-flagged {{orderViewFlagged}}" href="#">{{literals.flagged_activity}}</a>              </div>              <div id="maxui-news-activities" hidden>                  <input type="button" class="maxui-button" value="Carrega noves entrades">              </div>           <div id="maxui-timeline" style="{{showTimeline}}">              <div class="maxui-wrapper">                  <div id="maxui-preload" class="maxui-activities" style="height:0px;overflow:hidden">                      <div class="maxui-wrapper">                      </div>                  </div>                  <div id="maxui-activities" class="maxui-activities">                  </div>                  <div id="maxui-more-activities">                      <input type="button" class="maxui-button" value="{{literals.load_more}}">                  </div>              </div>           </div>           <div id="maxui-overlay-background" class="maxui-overlay">           </div>           <div id="maxui-overlay-wrapper" class="maxui-overlay">               <div id="maxui-overlay-panel">                   <div id="maxui-overlay-header">                        <h3 id="maxui-overlay-title">I\'m a overlay</h3>                        <i class="maxui-close maxui-icon-cancel"/>                   </div>                   <div id="maxui-overlay-content">                   </div>               </div>           </div>          </div>         </div>        {{/username}}        {{^username}}          No s\'ha definit cap usuari        {{/username}}        </div>            ')}};var max=max||{};!function(i){function t(t){var a=this;a.logtag="MESSAGING",a.maxui=t,a.active=!1,a.vhost="/",a.max_retries=3,a.retry_interval=3e3,a.debug=a.maxui.settings.enableAlerts,a.token=a.maxui.settings.oAuthToken,a.stompServer=a.maxui.settings.maxTalkURL,t.settings.domain?a.domain=t.settings.domain:a.domain=a.domainFromMaxServer(a.maxui.settings.maxServerURL),a.login="",a.domain&&(a.login+=a.domain+":"),a.login+=a.maxui.settings.username,a.ws=new SockJS(a.stompServer),a.bindings=[],a.specification={uuid:{id:"g",type:"string"},user:{id:"u",type:"object",fields:{username:{id:"u"},displayname:{id:"d"}}},action:{id:"a",type:"char",values:{add:{id:"a"},delete:{id:"d"},modify:{id:"m"},refresh:{id:"r"},ack:{id:"k"}}},object:{id:"o",type:"char",values:{message:{id:"m"},conversation:{id:"c"},tweet:{id:"t"},activity:{id:"a"},context:{id:"x"},comment:{id:"t"}}},data:{id:"d",type:"object"},source:{id:"s",type:"char",values:{max:{id:"m"},widget:{id:"w"},ios:{id:"i"},android:{id:"a"},tweety:{id:"t"},maxbunny:{id:"b"}}},domain:{id:"i",type:"string"},version:{id:"v",type:"string"},published:{id:"p",type:"date"}},a._specification={},_.each(a.specification,function(t,e,i){var n=_.clone(t);_.has(n,"values")&&(n.values={},_.each(t.values,function(t,e,i){n.values[t.id]=_.clone(t),n.values[t.id].name=e,delete n.values[t.id].id})),_.has(n,"fields")&&"object"===n.type&&(n.fields={},_.each(t.fields,function(t,e,i){n.fields[t.id]=_.clone(t),n.fields[t.id].name=e,delete n.fields[t.id].id})),n.name=e,delete n.id,a._specification[t.id]=n})}t.prototype.domainFromMaxServer=function(t){var e=t.replace(/\/$/,""),i=document.createElement("a");return i.href=e,_.last(i.pathname.split("/"))},t.prototype.start=function(){var e=this;e.maxui.logger.info("Connecting ...",e.logtag),e.connect();var i=1,n=setInterval(function(t){!e.active&&i<=e.max_retries?(e.maxui.logger.debug("Connection retry #{0}".format(i),e.logtag),e.ws.close(),e.ws=new SockJS(e.maxui.settings.maxTalkURL),e.connect()):(e.active||e.maxui.logger.error("Connection failure after {0} reconnect attempts".format(e.max_retries),e.logtag),clearInterval(n)),i+=1},e.retry_interval)},t.prototype.bind=function(t,e){this.bindings.push({key:this.pack(t),callback:e})},t.prototype.on_message=function(r,o){var s=this,t=_.filter(s.bindings,function(t){var e=_.pick(r,_.keys(t.key));if(_.isEqual(t.key,e))return t});_.isEmpty(t)?s.maxui.logger.warning("Ignoring received message\n{0}\n No binding found for this message".format(r),s.logtag):_.each(t,function(t,e,i){s.maxui.logger.debug('Matched binding "{1}"'.format(r,t.key),s.logtag);var n=s.unpack(r),a=o.replace(/(\w+)\.(.*)/g,"$1");n.destination=a,t.callback(n)})},t.prototype.disconnect=function(){this.stomp.disconnect()},t.prototype.connect=function(){var n=this;n.stomp=Stomp.over(n.ws),n.stomp.heartbeat.outgoing=0,n.stomp.heartbeat.incoming=0,n.stomp.debug=function(t){n.maxui.logger.debug(t,n.logtag)};var t="maxui";n.maxui.settings.generator&&(t+="[{0}]".format(n.maxui.settings.generator));var e={login:n.login,passcode:n.token,host:n.vhost,product:t,"product-version":n.maxui.version,platform:"{0} {1} / {2} {3}".format(i.ua.browser.name,i.ua.browser.version,i.ua.os.name,i.ua.os.version)};n.stomp.connect(e,function(t){n.stomp.subscribe("/exchange/{0}.subscribe".format(n.maxui.settings.username),function(t){var e=JSON.parse(t.body),i=/([^/])+$/.exec(t.headers.destination)[0];n.on_message(e,i)}),n.active=!0,n.maxui.logger.info("Succesfully connected to {0}".format(n.stompServer),n.logtag)},function(t){n.maxui.logger.error(t.body)})},t.prototype.pack=function(o){var s,c=this,u={};return _.each(o,function(t,e,i){var n=c.specification[e];if(_.isUndefined(n));else{var a;if(_.has(n,"values"))_.has(n.values,t)&&(a=n.values[t].id);else if(a=t,_.has(n,"fields")&&"object"===n.type&&_.isObject(a)){var r={};_.each(o[e],function(t,e,i){s=_.has(n.fields,e)?n.fields[e].id:e,r[s]=t}),a=r}_.isUndefined(a)||(u[n.id]=a)}}),u},t.prototype.unpack=function(o){var s,c=this,u={};return _.each(o,function(t,e,i){var n=c._specification[e];if(_.isUndefined(n));else{var a;if(_.has(n,"values"))_.has(n.values,t)&&(a=n.values[t].name);else if(a=t,_.has(n,"fields")&&"object"===n.type&&_.isObject(a)){var r={};_.each(o[e],function(t,e,i){s=_.has(n.fields,e)?n.fields[e].name:e,r[s]=t}),a=r}_.isUndefined(a)||(u[n.name]=a)}}),u},t.prototype.prepare=function(t){var e=this,i={source:"widget",version:e.maxui.version,user:{username:e.maxui.settings.username,displayname:e.maxui.settings.displayName},published:e.maxui.utils.rfc3339(e.maxui.utils.now()),uuid:uuid.v1()};return e.domain&&(i.domain=e.domain),_.extend(_.pick(t,_.keys(e.specification)),i)},t.prototype.send=function(t,e){var i=this.prepare(t);return this.stomp.send("/exchange/{0}.publish/{1}".format(this.maxui.settings.username,e),{},JSON.stringify(this.pack(i))),i},max.MaxMessaging=t}(jQuery);var max=max||{};!function(t){var i={debug:0,info:1,warn:2,error:3};function e(t){this.level=0}e.prototype.setLevel=function(t){this.level=i[t]},e.prototype.log=function(t,e){try{window.console.log("{0}: {1}".format(e,t))}catch(t){}},e.prototype.debug=function(t){var e="MAXUI";1<arguments.length&&(e=arguments[1]);this.level<=i.debug&&this.log(t,e)},e.prototype.info=function(t){var e="MAXUI";1<arguments.length&&(e=arguments[1]);this.level<=i.info&&this.log(t,e)},e.prototype.warn=function(t){var e="MAXUI";1<arguments.length&&(e=arguments[1]);this.level<=i.warn&&this.log(t,e)},e.prototype.error=function(t){var e="MAXUI";1<arguments.length&&(e=arguments[1]);this.level<=i.error&&this.log(t,e)},max.MaxLogging=e}(jQuery);var max=max||{};max.literals=function(t){var e={en:{cancel:"Cancel",delete:"Delete",months:["January","February","March","April","May","June","July","August","September","October","November","December"],new_activity_text:"Write something...",activity:"activity",conversations_lower:"chats",conversations:"Chats",conversations_list:"chats list",conversations_info_title:"Chat information",conversations_info_participants:"Participants",conversations_info_owner:"owner",conversations_info_add:"Add participant...",conversations_info_created:"Created",conversations_info_leave:"Leave chat",conversations_info_delete:"Delete chat",conversations_info_delete_warning:"Warning!",conversations_info_delete_help:"If you delete the chat, the participants will not be able to see the messages anymore. To avoid this, cancel and transfer the ownership to someone else.",conversations_info_kick_message_1:"Click to kick",conversations_info_kick_message_2:"out of this chat",conversations_info_transfer_message_1:"Click to make",conversations_info_transfer_message_2:"the owner of this chat",participants:"Talk to",chats_load_older:"Load older",conversation_name:"Chat name",message:"Message",no_chats:"No chats already",no_match_found:"No match found",new_conversation_text:"Add participants and send a message to start a chat",new_activity_post:"Post activity",toggle_comments:"comments",new_comment_text:"Comment something...",new_comment_post:"Post comment",load_more:"Load more",context_published_in:"Published in",generator_via:"via",search_text:"Search in posts...",and_more:"and more...",new_message_post:"Send message",post_permission_unauthorized:"You''re not authorized to post on this context",post_permission_not_here:"You're not mentioning @anyone",post_permission_not_enough_participants:"You have to add participants",post_permission_missing_displayName:"You have to name the chat",delete_activity_confirmation:"Are you sure?",delete_activity_delete:"Delete",delete_activity_cancel:"Cancel",delete_activity_icon:"delete",flag_activity_icon:"flagged",favorites_filter_hint:"Filter by favorited activity",favorites:"Favorites",favorite:"favorite",unfavorite:"unfavorite",like:"like",unlike:"unlike",recent_activity:"Latest activity",valued_activity:"Most valued activity",flagged_activity:"Flagged activity",recent_favorited_activity:"Latest favorites",valued_favorited_activity:"Most valued favorites"},es:{cancel:"Cancelar",delete:"Eliminar",months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],new_activity_text:"Escribe algo...",activity:"actividad",conversations_lower:"chats",conversations:"Chats",conversations_list:"lista de chats",conversations_info_title:"Información del chat",conversations_info_participants:"Participantes",conversations_info_owner:"propietario",conversations_info_add:"Añade participante...",conversations_info_created:"Creada",conversations_info_leave:"Abandonar chat",conversations_info_delete:"Borra el chat",conversations_info_delete_warning:"Atención!",conversations_info_delete_help:"Si eliminas el chat, los participantes dejarán de ver los mensajes. Para evitar esto, cancela y luego traspasa el chat a otra persona.",conversations_info_kick_message_1:"Clica para echar a",conversations_info_kick_message_2:"de este chat",conversations_info_transfer_message_1:"Clica para dar a ",conversations_info_transfer_message_2:"la administración del chat",participants:"Chatear con",chats_load_older:"Cargar antiguos",conversation_name:"Nombre del chat",message:"Mensaje",no_chats:"No hay chats",no_match_found:"No hay coincidencias",new_conversation_text:"Añade participantes y envia el mensaje para iniciar un chat",new_activity_post:"Publica",toggle_comments:"comentarios",new_comment_text:"Comenta algo...",new_comment_post:"Comenta",load_more:"Cargar más",context_published_in:"Publicado en",generator_via:"via",search_text:"Busca en las entradas...",and_more:"i más...",new_message_post:"Envia el mensaje",post_permission_unauthorized:"No estas autorizado a publicar en este contexto",post_permission_not_here:"No estas citando a @nadie",post_permission_not_enough_participants:"Tienes que añadir participantes",post_permission_missing_displayName:"Tienes que dar un nombre al chat",delete_activity_confirmation:"Estás seguro?",delete_activity_delete:"Borrar",delete_activity_cancel:"Cancelar",delete_activity_icon:"borrar",flag_activity_icon:"destacada",favorites_filter_hint:"Filtra por actividad favorita",favorites:"Favoritos",favorite:"favorito",unfavorite:"quitar favorito",like:"me gusta",unlike:"ya no me gusta",recent_activity:"Últimas actividades",valued_activity:"Actividades más valoradas",flagged_activity:"Actividades destacadas",recent_favorited_activity:"Últimas favoritas",valued_favorited_activity:"Favoritas más valoradas"},ca:{cancel:"Cancelar",delete:"Elimina",months:["gener","febrer","març","abril","maig","juny","juliol","agost","setembre","octubre","novembre","desembre"],new_activity_text:"Escriu alguna cosa...",activity:"activitat",conversations_lower:"xats",conversations:"Xats",conversations_list:"llista de xats",conversations_info_title:"Informació del xat",conversations_info_participants:"Participants",conversations_info_owner:"propietari",conversations_info_add:"Afegeix participant...",conversations_info_created:"Creada",conversations_info_leave:"Marxar del xat",conversations_info_delete:"Esborra el xat",conversations_info_delete_warning:"Alerta!",conversations_info_delete_help:"Si elimines el xat, la resta de participants deixaran de veure els missatges. Per evitar-ho, cancela i traspassa el xat a algú altre.",conversations_info_kick_message_1:"Clica per fer fora a ",conversations_info_kick_message_2:"d'aquest xat",conversations_info_transfer_message_1:"Clica per fer a",conversations_info_transfer_message_2:"l'administrador d'aquest xat",participants:"Xateja amb",chats_load_older:"Carregar antics",conversation_name:"Nom del xat",message:"Missatge",no_chats:"No hi ha xats",no_match_found:"No s'han trobat coincidències",new_conversation_text:"Afegeix participants i envia el missatge per iniciar un xat",new_activity_post:"Publica",toggle_comments:"comentaris",new_comment_text:"Comenta alguna cosa...",new_comment_post:"Comenta",load_more:"Carrega'n més",context_published_in:"Publicat a",generator_via:"via",search_text:"Cerca a les entrades...",and_more:"i més...",new_message_post:"Envia el missatge",post_permission_unauthorized:"No estàs autoritzat a publicar en aquest contexte",post_permission_not_here:"No estas citant a @ningú",post_permission_not_enough_participants:"Has d'afegir participants",post_permission_missing_displayName:"Tens que posar nom al xat",delete_activity_confirmation:"Estàs segur?",delete_activity_delete:"Esborra",delete_activity_cancel:"No ho toquis!",delete_activity_icon:"esborra",flag_activity_icon:"destacada",favorites_filter_hint:"Filtra per activitat favorita",favorites:"Favorits",favorite:"favorit",unfavorite:"treure favorit",like:"m'agrada",unlike:"ja no m'agrada",recent_activity:"Darreres activitats",valued_activity:"Activitats més valorades",flagged_activity:"Activitats destacades",recent_favorited_activity:"Darreres favorites",valued_favorited_activity:"Favorites més valorades"}};return e[t]};var max=max||{};function MaxClient(){this.ROUTES={users:"/people",user:"/people/{0}",avatar:"/people/{0}/avatar",user_activities:"/people/{0}/activities",timeline:"/people/{0}/timeline",user_comments:"/people/{0}/comments",user_shares:"/people/{0}/shares",user_likes:"/people/{0}/likes",follows:"/people/{0}/follows",follow:"/people/{0}/follows/{1}",subscriptions:"/people/{0}/subscriptions",activities:"/contexts/{0}/activities",activity:"/activities/{0}",comments:"/activities/{0}/comments",comment:"/activities/{0}/comments/{1}",likes:"/activities/{0}/likes",like:"/activities/{0}/likes/{1}",flag:"/activities/{0}/flag",favorites:"/activities/{0}/favorites",favorite:"/activities/{0}/favorites/{1}",shares:"/activities/{0}/shares",share:"/activities/{0}/shares/{1}",conversations:"/conversations",conversation:"/conversations/{0}",conversation_owner:"/conversations/{0}/owner",user_conversation:"/people/{0}/conversations/{1}",messages:"/conversations/{0}/messages",context:"/contexts/{0}"}}max.utils=function(){var l={};return{setSettings:function(t){l=t},freezeEvent:function(t){return t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1},normalizeWhiteSpace:function(t,e){t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/\n /,"\n");var i=!0;return 1<arguments.length&&(i=e),!0===i&&(t=t.replace(/[ ]{2,}/gi," ")),t},formatText:function(t){return t&&(t=(t=(t=t.replace(/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(t){var e=t;return e.match("^https?://")||(e="http://"+e),'<a href="'+e+'">'+t+"</a>"})).replace(/(\s|^)#{1}(\w+)/gi,function(){var t=arguments[1],e=arguments[2];return'<a class="maxui-hashtag" href="#" value="'+e+'">'+t+"#"+e+"</a>"})).replace(/\r?\n/gi,"<br/>")),t},isCORSCapable:function(){return void 0!==(new XMLHttpRequest).withCredentials},removeValueFrom:function(t){for(var e,i,n=arguments,a=n.length;1<a&&t.length;)for(e=n[--a];-1!==(i=t.indexOf(e));)t.splice(i,1);return t},timestamp:function(){return new Date/1},now:function(){return new Date},rfc3339:function(t){function e(t){return t<10?"0"+t:t}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z"},formatDate:function(t,e){var i=new Date,n="",a="",r=new Date,o=t.match("^([-+]?)(\\d{4,})(?:-?(\\d{2})(?:-?(\\d{2})(?:[Tt ](\\d{2})(?::?(\\d{2})(?::?(\\d{2})(?:\\.(\\d{1,3})(?:\\d+)?)?)?)?(?:[Zz]|(?:([-+])(\\d{2})(?::?(\\d{2}))?)?)?)?)?)?$");if(o){for(var s=[2,3,4,5,6,7,8,10,11],c=s.length-1;0<=c;--c)o[s[c]]=void 0!==o[s[c]]&&0<o[s[c]].length?parseInt(o[s[c]],10):0;"-"===o[1]&&(o[2]*=-1);var u=Date.UTC(o[2],o[3]-1,o[4],o[5],o[6],o[7],o[8]);void 0!==o[9]&&0<o[9].length&&(u+=("+"===o[9]?-1:1)*(3600*o[10]*1e3+60*o[11]*1e3)),0<=o[2]&&o[2]<=99&&(u-=59958144e6);return r.setTime(u),i.getTime()-u<2592e5?n=jQuery.easydate.format_date(r,e):("en"===e?n="{0} {1}".format(o[4],l.literals.months[o[3]-1]):"es"===e?n="{0} de {1}".format(o[4],l.literals.months[o[3]-1]):"ca"===e&&(a="de ",4!==o[3]&&8!==o[3]&&10!==o[3]||(a="d'"),n="{0} {2}{1}".format(o[4],l.literals.months[o[3]-1],a)),31536e6<i.getTime()-u&&(n="{0}/{1}/{2}".format(o[4],o[3],o[2]))),n}return null},utf8_decode:function(t){var e=[],i=0,n=0,a=0,r=0,o=0;for(t+="";i<t.length;)(a=t.charCodeAt(i))<128?(e[n++]=String.fromCharCode(a),i++):191<a&&a<224?(r=t.charCodeAt(i+1),e[n++]=String.fromCharCode((31&a)<<6|63&r),i+=2):(r=t.charCodeAt(i+1),o=t.charCodeAt(i+2),e[n++]=String.fromCharCode((15&a)<<12|(63&r)<<6|63&o),i+=3);return e.join("")},sha1:function(t){function e(t,e){return t<<e|t>>>32-e}function i(t){var e,i="";for(e=7;0<=e;e--)i+=(t>>>4*e&15).toString(16);return i}var n,a,r,o,s,c,u,l,d,f=new Array(80),p=1732584193,m=4023233417,v=2562383102,h=271733878,g=3285377520,y=(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e+=String.fromCharCode(n):(127<n&&n<2048?e+=String.fromCharCode(n>>6|192):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128)),e+=String.fromCharCode(63&n|128))}return e}(t)).length,x=[];for(a=0;a<y-3;a+=4)r=t.charCodeAt(a)<<24|t.charCodeAt(a+1)<<16|t.charCodeAt(a+2)<<8|t.charCodeAt(a+3),x.push(r);switch(y%4){case 0:a=2147483648;break;case 1:a=t.charCodeAt(y-1)<<24|8388608;break;case 2:a=t.charCodeAt(y-2)<<24|t.charCodeAt(y-1)<<16|32768;break;case 3:a=t.charCodeAt(y-3)<<24|t.charCodeAt(y-2)<<16|t.charCodeAt(y-1)<<8|128}for(x.push(a);x.length%16!=14;)x.push(0);for(x.push(y>>>29),x.push(y<<3&4294967295),n=0;n<x.length;n+=16){for(a=0;a<16;a++)f[a]=x[n+a];for(a=16;a<=79;a++)f[a]=e(f[a-3]^f[a-8]^f[a-14]^f[a-16],1);for(o=p,s=m,c=v,u=h,l=g,a=0;a<=19;a++)d=e(o,5)+(s&c|~s&u)+l+f[a]+1518500249&4294967295,l=u,u=c,c=e(s,30),s=o,o=d;for(a=20;a<=39;a++)d=e(o,5)+(s^c^u)+l+f[a]+1859775393&4294967295,l=u,u=c,c=e(s,30),s=o,o=d;for(a=40;a<=59;a++)d=e(o,5)+(s&c|s&u|c&u)+l+f[a]+2400959708&4294967295,l=u,u=c,c=e(s,30),s=o,o=d;for(a=60;a<=79;a++)d=e(o,5)+(s^c^u)+l+f[a]+3395469782&4294967295,l=u,u=c,c=e(s,30),s=o,o=d;p=p+o&4294967295,m=m+s&4294967295,v=v+c&4294967295,h=h+u&4294967295,g=g+l&4294967295}return(d=i(p)+i(m)+i(v)+i(h)+i(g)).toLowerCase()}}},Object.keys||(Object.keys=function(t){var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.push(e);return i}),String.prototype.format=function(){var e=arguments;return this.replace(/\{\d+\}/g,function(t){return e[t.match(/\d+/)]})},MaxClient.prototype.configure=function(t){this.url=t.server,this.mode=t.mode,this.token=t.token,this.actor={objectType:"person",username:t.username}},MaxClient.prototype.POST=function(t,e,i){var n=this,a="{0}{1}".format(this.url,t),r={};return 3<arguments.length&&(r=arguments[3]),jQuery.ajax({url:a,beforeSend:function(t){t.setRequestHeader("X-Oauth-Token",n.token),t.setRequestHeader("X-Oauth-Username",n.actor.username),t.setRequestHeader("X-Oauth-Scope","widgetcli")},type:"POST",contentType:"application/json",data:JSON.stringify(e),async:!0,dataType:"json"}).done(function(t){i.call(t),r.done&&jQuery(window).trigger(r.done,t)}).fail(function(t){jQuery(window).trigger("maxclienterror",t),r.fail&&jQuery(window).trigger(r.fail,t)}),!0},MaxClient.prototype.PUT=function(t,e,i){var n=this,a="{0}{1}".format(this.url,t),r={};return 3<arguments.length&&(r=arguments[3]),jQuery.ajax({url:a,beforeSend:function(t){t.setRequestHeader("X-Oauth-Token",n.token),t.setRequestHeader("X-Oauth-Username",n.actor.username),t.setRequestHeader("X-Oauth-Scope","widgetcli"),t.setRequestHeader("X-HTTP-Method-Override","PUT")},contentType:"application/json",type:"POST",data:JSON.stringify(e),async:!0,dataType:"json"}).done(function(t){i.call(t),r.done&&jQuery(window).trigger(r.done,t)}).fail(function(t){jQuery(window).trigger("maxclienterror",t),r.fail&&jQuery(window).trigger(r.fail,t)}),!0},MaxClient.prototype.DELETE=function(t,e,i){var n=this,a="{0}{1}".format(this.url,t),r={};return 2<arguments.length&&(r=i),jQuery.ajax({url:a,beforeSend:function(t){t.setRequestHeader("X-Oauth-Token",n.token),t.setRequestHeader("X-Oauth-Username",n.actor.username),t.setRequestHeader("X-Oauth-Scope","widgetcli"),t.setRequestHeader("X-HTTP-Method-Override","DELETE")},type:"POST",data:JSON.stringify(e),async:!0,dataType:"json"}).done(function(t){i.call(t),r.done&&jQuery(window).trigger(r.done,t)}).fail(function(t){jQuery(window).trigger("maxclienterror",t),r.fail&&jQuery(window).trigger(r.fail,t)}),!0},MaxClient.prototype.GET=function(t,e,n){var i=this,a="{0}{1}".format(this.url,t),r={};3<arguments.length&&(r=arguments[3]),0<Object.keys(e).length&&(a+="?"+jQuery.param(e,!0));var o={url:a,beforeSend:function(t){t.setRequestHeader("X-Oauth-Token",i.token),t.setRequestHeader("X-Oauth-Username",i.actor.username),t.setRequestHeader("X-Oauth-Scope","widgetcli")},processData:!0,type:"GET",async:!0,dataType:"json"};return 3<arguments.length&&_.extend(o,arguments[3]),jQuery.ajax(o).done(function(t,e,i){r.done&&jQuery(window).trigger(r.done),n.apply(i,[t])}).fail(function(t){jQuery(window).trigger("maxclienterror",t),r.fail&&jQuery(window).trigger(r.fail)}),!0},MaxClient.prototype.getUserData=function(t,e){var i=this.ROUTES.user.format(t);this.GET(i,{},e)},MaxClient.prototype.getUsersList=function(t,e){var i=this.ROUTES.users,n={username:t};this.GET(i,n,e)},MaxClient.prototype.getContext=function(t,e){var i=this.ROUTES.context.format(t);this.GET(i,{},e)},MaxClient.prototype.getUserTimeline=function(t,e){var i=this.ROUTES.timeline.format(t),n={};2<arguments.length&&(n=arguments[2]),this.GET(i,n,e)},MaxClient.prototype.getActivities=function(t,e){var i=this.ROUTES.activities.format(t.context),n={};2<arguments.length&&(n=arguments[2]),t.tags&&0<t.tags.length&&(n.context_tags=t.tags),this.GET(i,n,e)},MaxClient.prototype.getCommentsForActivity=function(t,e){var i=this.ROUTES.comments.format(t);this.GET(i,{},e)},MaxClient.prototype.addComment=function(t,e,i){var n={actor:{},object:{objectType:"comment",content:""}};n.actor=this.actor,n.object.content=t;var a=this.ROUTES.comments.format(e);this.POST(a,n,i)},MaxClient.prototype.addActivity=function(t,e,i){var n={object:{objectType:"note",content:""}};if(0<e.length){n.contexts=[];for(var a=0;a<e.length;a++)n.contexts.push({objectType:"context",url:e[a]})}n.object.content=t,3<arguments.length&&(n.generator=arguments[3]);var r=this.ROUTES.user_activities.format(this.actor.username);this.POST(r,n,i,{done:"maxui-posted-activity",fail:"maxui-failed-activity"})},MaxClient.prototype.removeActivity=function(t,e){var i=this.ROUTES.activity.format(t);this.DELETE(i,{},e)},MaxClient.prototype.removeActivityComment=function(t,e,i){var n=this.ROUTES.comment.format(t,e);this.DELETE(n,{},i)},MaxClient.prototype.getConversationSubscription=function(t,e,i){var n=this.ROUTES.user_conversation.format(e,t);this.GET(n,{},i)},MaxClient.prototype.getConversation=function(t,e){var i=this.ROUTES.conversation.format(t);this.GET(i,{},e)},MaxClient.prototype.modifyConversation=function(t,e,i){var n={displayName:e},a=this.ROUTES.conversation.format(t);this.PUT(a,n,i)},MaxClient.prototype.addUserToConversation=function(t,e,i){var n=this.ROUTES.user_conversation.format(e,t);this.POST(n,{},i)},MaxClient.prototype.kickUserFromConversation=function(t,e,i){var n=this.ROUTES.user_conversation.format(e,t);this.DELETE(n,{},i)},MaxClient.prototype.deleteConversation=function(t,e){var i=this.ROUTES.conversation.format(t);this.DELETE(i,{},e)},MaxClient.prototype.leaveConversation=function(t,e,i){var n=this.ROUTES.user_conversation.format(e,t);this.DELETE(n,{},i)},MaxClient.prototype.transferConversationOwnership=function(t,e,i){var n={actor:{username:e}},a=this.ROUTES.conversation_owner.format(t);this.PUT(a,n,i)},MaxClient.prototype.getConversationsForUser=function(t,e){var i=this.ROUTES.conversations;this.GET(i,{},e)},MaxClient.prototype.getMessageImage=function(t,e){var i={processData:!1,dataType:void 0,contentType:"application/base64"};this.GET(t,{},e,i)},MaxClient.prototype.getMessagesForConversation=function(t,e,i){var n=this.ROUTES.messages.format(t),a=e;this.GET(n,a,i)},MaxClient.prototype.addMessageAndConversation=function(t,e){var i={object:{objectType:"note",content:t.message},contexts:[{objectType:"conversation",participants:t.participants}]};t.displayName&&(i.contexts[0].displayName=t.displayName);var n=this.ROUTES.conversations;this.POST(n,i,e)},MaxClient.prototype.addMessage=function(t,e,i){var n={object:{objectType:"note",content:""}};n.object.content=t;var a=this.ROUTES.messages.format(e);this.POST(a,n,i)},MaxClient.prototype.follow=function(t,e){var i={object:{objectType:"person",username:""}};i.object.username=t;var n=this.ROUTES.follow.format(this.actor.username,t);this.POST(n,i,e)},MaxClient.prototype.favoriteActivity=function(t,e){var i=this.ROUTES.favorites.format(t);this.POST(i,{},e)},MaxClient.prototype.unfavoriteActivity=function(t,e){var i=this.ROUTES.favorite.format(t,this.actor.username);this.DELETE(i,{},e)},MaxClient.prototype.likeActivity=function(t,e){var i=this.ROUTES.likes.format(t);this.POST(i,{},e)},MaxClient.prototype.unlikeActivity=function(t,e){var i=this.ROUTES.like.format(t,this.actor.username);this.DELETE(i,{},e)},MaxClient.prototype.flagActivity=function(t,e){var i=this.ROUTES.flag.format(t);this.POST(i,{},e)},MaxClient.prototype.unflagActivity=function(t,e){var i=this.ROUTES.flag.format(t);this.DELETE(i,{},e)},function(b){b.fn.maxUIActivity=function(t){var x=this;x.version="4.1.21",x.templates=max.templates(),x.utils=max.utils();var e={maxRequestsAPI:"jquery",maxServerURL:"https://max.upc.edu",readContext:void 0,writeContexts:[],activitySource:"timeline",enableAlerts:!1,UISection:"timeline",disableTimeline:!1,disableConversations:!0,conversationsSection:"conversations",currentConversationSection:"conversations",activitySortOrder:"comments",activitySortView:"recent",maximumConversations:20,contextTagsFilter:[],scrollbarWidth:10,widgetWidth:"0",sectionHorizontalPadding:20,widgetBorder:2,loglevel:"info",hidePostboxOnTimeline:!1,maxTalkURL:"",generator:"",domain:"",showSubscriptionList:!1};x.settings=b.extend(e,t),x.logger=new max.MaxLogging(x),x.logger.setLevel(x.settings.loglevel),x.utils.isCORSCapable()||x.settings.maxServerURLAlias&&(x.settings.maxServerURL=x.settings.maxServerURLAlias),x.settings.maxTalkURL=x.utils.normalizeWhiteSpace(x.settings.maxTalkURL),(_.isUndefined(x.settings.maxTalkURL)||""===x.settings.maxTalkURL)&&(x.settings.maxTalkURL=x.settings.maxServerURL+"/stomp"),x.settings.domain=x.utils.normalizeWhiteSpace(x.settings.domain),"none"===x.settings.domain.toLowerCase()&&(x.settings.domain=""),"timeline"===x.settings.UISection&&"timeline"===x.settings.activitySource&&x.settings.readContext&&(x.settings.readContext=void 0,x.settings.writeContexts=[]),x.settings.showSubscriptionList&&"activities"===x.settings.activitySource&&(x.settings.showSubscriptionList=!1),x.language=t.language||"en";var i=t.literals||{};if(x.settings.literals=b.extend(max.literals(x.language),i),x.settings.readContext){x.settings.readContextHash=x.utils.sha1(x.settings.readContext),x.settings.writeContexts.push(x.settings.readContext),x.settings.writeContextsHashes=[];for(var n=0;n<x.settings.writeContexts.length;n++)x.settings.writeContextsHashes.push(x.utils.sha1(x.settings.writeContexts[n]))}x.settings.avatarURLpattern||(x.settings.avatarURLpattern=x.settings.maxServerURL+"/people/{0}/avatar"),x.settings.contextAvatarURLpattern||(x.settings.contextAvatarURLpattern=x.settings.maxServerURL+"/contexts/{0}/avatar"),x.settings.conversationAvatarURLpattern||(x.settings.conversationAvatarURLpattern=x.settings.maxServerURL+"/conversations/{0}/avatar"),x.settings.enableAlerts&&b(window).bind("maxclienterror",function(t,e){var i=JSON.parse(e.responseText);alert('The server responded with a "{0}" error, with the following message: "{1}". \n\nPlease try again later or contact administrator at admin@max.upc.edu.'.format(i.error,i.error_description))}),x.maxClient=new MaxClient;var a={server:x.settings.maxServerURL,mode:x.settings.maxRequestsAPI,username:x.settings.username,token:x.settings.oAuthToken};return x.maxClient.configure(a),x.messaging=new max.MaxMessaging(x),x.conversations=new max.views.MaxConversations(x,{}),x.settings.disableConversations||(x.messaging.bind({action:"add",object:"message"},function(t){x.conversations.ReceiveMessage(t)}),x.messaging.bind({action:"add",object:"conversation"},function(t){x.conversations.ReceiveConversation(t)}),x.messaging.bind({action:"refresh",object:"conversation"},function(t){x.conversations.messagesview.load(t.destination)}),x.messaging.bind({action:"ack",object:"message"},function(t){x.conversations.messagesview.ack(t)})),x.utils.setSettings(x.settings),b.fn.hidePostboxActivity=function(){var t=this;if("timeline"===t.settings.activitySource&&0<t.settings.subscriptionsWrite.length)return t.settings.hidePostboxOnTimeline;for(var e in t.settings.subscriptionsWrite){if(t.settings.subscriptionsWrite[e].hash===t.settings.readContext)return t.settings.hidePostboxOnTimeline}return!0},this.maxClient.getUserData(x.settings.username,function(t){x.settings.displayName=t.displayName||x.settings.username;var e={},i=[];if(t.subscribedTo&&t.subscribedTo&&0<t.subscribedTo.length)for(var n=0;n<t.subscribedTo.length;n++){var a=t.subscribedTo[n];e[a.hash]={},e[a.hash].permissions={};for(var r=0;r<a.permissions.length;r++){var o=a.permissions[r];e[a.hash].permissions[o]=!0,"write"===o&&i.push({hash:a.url,displayname:a.displayName})}}x.settings.subscriptionsWrite=i,x.settings.subscriptions=e,"timeline"===x.settings.activitySource&&0<i.length&&x.settings.writeContexts.push(i[0].hash),x.settings.disableConversations||(x.messaging.start(),b(window).on("beforeunload",function(t){return x.messaging.disconnect()}));var s="conversations"===x.settings.UISection,c="timeline"===x.settings.UISection,u=!1===x.settings.disableTimeline&&!c,l=!1===x.settings.disableConversations&&!s,d=x.width()-x.settings.scrollbarWidth,f="recent"===x.settings.activitySortView,p="likes"===x.settings.activitySortView,m="flagged"===x.settings.activitySortView,v={username:x.settings.username,literals:x.settings.literals,showMaxUIClass:s?"maxui-container-chat":"maxui-container-activity",showConversations:s?"display:block;":"display:none;",showConversationsToggle:l?"display:block;":"display:none;",showTimeline:c?"display:block;":"display:none;",showTimelineToggle:u?"display:block;":"display:none;",orderViewRecent:f?"active":"",orderViewLikes:p?"active":"",orderViewFlagged:m?"active":"",messagesStyle:"width:{0}px;left:{0}px;".format(d),hidePostbox:x.hidePostboxActivity()},h=x.templates.mainUIActivity.render(v);if(x.html(h),x.overlay=new max.views.MaxOverlay(x),x.settings.widgetWidth=x.width(),x.settings.sectionsWidth=x.settings.widgetWidth-x.settings.scrollbarWidth-x.settings.widgetBorder,x.settings.disableConversations||(x.conversations.render(),x.conversations.listview.load(t.talkingIn)),"conversations"===x.settings.UISection){x.bindEventsActivity(),x.toggleSectionActivity("conversations"),x.renderPostboxActivity();var g=x.settings.literals.new_conversation_text;b("#maxuiactivity-widget-container #maxui-newactivity-box textarea").val(g).attr("data-literal",g)}else if("timeline"===x.settings.UISection){var y={recent:x.settings.activitySortOrder,likes:"likes",flagged:"flagged"};x.printActivitiesActivity({sortBy:y[x.settings.activitySortView]},function(t){x.bindEventsActivity()})}}),x},b.fn.bindEventsActivity=function(){var y=this;b("#maxuiactivity-widget-container #maxui-more-activities .maxui-button").click(function(t){if(t.preventDefault(),b("#maxuiactivity-widget-container #maxui-search").hasClass("folded"))y.loadMoreActivitiesActivity();else{var e=b(".maxui-activity:last").attr("id");y.reloadFiltersActivity(e)}}),b("#maxuiactivity-widget-container #maxui-news-activities .maxui-button").click(function(t){y.loadNewsActivitiesActivity()}),b("#maxuiactivity-widget-container #maxui-search-toggle").click(function(t){t.preventDefault(),b(this).hasClass("maxui-disabled")||(b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded"),b("#maxuiactivity-widget-container #maxui-search").hasClass("folded")?y.printActivitiesActivity({}):y.reloadFiltersActivity())}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-commentaction",function(t){t.preventDefault(),window.status="",b(this).closest(".maxui-activity").find(".maxui-comments").toggle(200)}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-actor",function(t){t.preventDefault();var e=b(this).find(".maxui-username").text();y.addFilterActivity({type:"actor",value:e}),b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded",!1)}),b("#maxuiactivity-widget-container #maxui-search").on("click","#maxui-favorites-filter",function(t){t.preventDefault();var e=b(t.currentTarget),i=!e.hasClass("active"),n="",a="";a=i?(y.addFilterActivity({type:"favorites",value:!0,visible:!1}),n=y.settings.literals.valued_favorited_activity,y.settings.literals.recent_favorited_activity):(y.delFilterActivity({type:"favorites",value:!0}),n=y.settings.literals.valued_activity,y.settings.literals.recent_activity),e.toggleClass("active",i),b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-most-recent").text(a),b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-most-valued").text(n)}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-hashtag",function(t){t.preventDefault(),y.addFilterActivity({type:"hashtag",value:b(this).attr("value")}),b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded",!1)}),b("#maxuiactivity-widget-container #maxui-subscriptions").on("change",function(){var t=b("#maxuiactivity-widget-container #maxui-subscriptions :selected").val();if("timeline"!==t){y.settings.writeContexts=[],y.settings.writeContextsHashes=[],y.settings.writeContexts.push(t);for(var e=0;e<y.settings.writeContexts.length;e++)y.settings.writeContextsHashes.push(y.utils.sha1(y.settings.writeContexts[e]))}else y.settings.writeContexts=[],y.settings.writeContextsHashes=void 0}),b("#maxuiactivity-widget-container #maxui-search-filters").on("click",".maxui-close",function(t){t.preventDefault();var e=b(this.parentNode.parentNode);y.delFilterActivity({type:e.attr("type"),value:e.attr("value")})}),b("#maxuiactivity-widget-container #maxui-new-participants").on("click",".maxui-close",function(t){t.preventDefault();var e=b(this.parentNode.parentNode);y.delPersonActivity({username:e.attr("username")})}),b("#maxuiactivity-widget-container #maxui-new-displayName").on("keyup","input",function(t){t.preventDefault(),y.reloadPersonsActivity()}),b("#maxuiactivity-widget-container #maxui-newactivity").on("click",".maxui-prediction",function(t){t.preventDefault();var e=b(this),i=b("#maxuiactivity-widget-container #maxui-newactivity-box textarea"),n=b("#maxuiactivity-widget-container #maxui-newactivity #maxui-predictive"),a=i.val(),r=new RegExp("^\\s*@([\\w\\.]+)"),o=a.replace(r,"@"+e.text()+" ");n.hide(),i.val(o),i.focus()}),b(document).on("click",function(t){b(".maxui-predictive").hide()}),b("#maxuiactivity-widget-container #maxui-conversation-predictive").on("click",".maxui-prediction",function(t){t.preventDefault();var e=b(this),i=b("#maxuiactivity-widget-container #maxui-add-people-box .maxui-text-input"),n=b("#maxuiactivity-widget-container #maxui-conversation-predictive"),a=e.attr("data-username"),r=e.attr("data-displayname");y.addPersonActivity({username:a,displayName:r}),n.hide(),i.val("").focus()}),b("#maxuiactivity-widget-container #maxui-show-conversations").on("click",function(t){t.preventDefault(),window.status="",y.toggleSectionActivity("conversations")}),b("#maxuiactivity-widget-container #maxui-show-timeline").on("click",function(t){t.preventDefault(),window.status="",y.printActivitiesActivity({},function(t){y.toggleSectionActivity("timeline")})}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-action.maxui-favorites",function(t){t.preventDefault();var e=b(this),i=b(this).closest(".maxui-activity").attr("id");e.hasClass("maxui-favorited")?y.maxClient.unfavoriteActivity(i,function(t){e.toggleClass("maxui-favorited",!1)}):y.maxClient.favoriteActivity(i,function(t){e.toggleClass("maxui-favorited",!0)})}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-action.maxui-likes",function(t){t.preventDefault();var e=b(this),i=b(this).closest(".maxui-activity").attr("id"),n=e.hasClass("maxui-liked"),a=e.children("strong");n?(y.maxClient.unlikeActivity(i,function(t){e.toggleClass("maxui-liked",!1)}),a.text(parseInt(a.text(),10)-1)):(y.maxClient.likeActivity(i,function(t){e.toggleClass("maxui-liked",!0)}),a.text(parseInt(a.text(),10)+1))}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-action.maxui-flag",function(t){t.preventDefault();var e=b(this),i=b(this).closest(".maxui-activity"),n=i.attr("id");e.hasClass("maxui-flagged")?y.maxClient.unflagActivity(n,function(t){e.toggleClass("maxui-flagged",!1),i.toggleClass("maxui-flagged",!1),y.printActivitiesActivity({})}):y.maxClient.flagActivity(n,function(t){e.toggleClass("maxui-flagged",!0),i.toggleClass("maxui-flagged",!1),y.printActivitiesActivity({})})}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-action.maxui-delete",function(t){t.preventDefault();var e=b(this).closest(".maxui-activity").find(".maxui-actions > .maxui-popover");e.is(":visible")?(e.animate({opacity:0},300),b(".maxui-popover").css({opacity:0}).hide()):(b(".maxui-popover").css({opacity:0}).hide(),e.show(),e.animate({opacity:1},300))}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-actions .maxui-button-cancel",function(t){t.preventDefault(),b(".maxui-popover:visible").css({opacity:0}).hide()}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-actions .maxui-button-delete",function(t){t.preventDefault();var i=b(this).closest(".maxui-activity"),e=i.attr("id");y.maxClient.removeActivity(e,function(t){var e=b(".maxui-popover:visible").animate({opacity:0},300);i.css({height:i.height(),"min-height":"auto"}),i.animate({height:0,opacity:0},100,function(t){i.remove(),e.hide()})})}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-delete-comment",function(t){t.preventDefault();var e=b(this).closest(".maxui-comment").find(".maxui-popover");e.is(":visible")?(e.animate({opacity:0},300),b(".maxui-popover").css({opacity:0}).hide()):(b(".maxui-popover").css({opacity:0}).hide(),e.show(),e.animate({opacity:1},300))}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-comment .maxui-button-cancel",function(t){t.preventDefault(),b(".maxui-popover").css({opacity:0}).hide()}),b("#maxuiactivity-widget-container #maxui-activities").on("click",".maxui-comment .maxui-button-delete",function(t){t.preventDefault();var i=b(this).closest(".maxui-comment"),n=i.closest(".maxui-activity"),e=n.attr("id"),a=i.attr("id");y.maxClient.removeActivityComment(e,a,function(){var e=b(".maxui-popover").animate({opacity:0},300);i.css({height:n.height(),"min-height":"auto"}),i.animate({height:0,opacity:0},100,function(t){i.remove(),e.hide()})})}),b("#maxuiactivity-widget-container #maxui-activity-sort").on("click","a.maxui-sort-action.maxui-most-recent",function(t){t.preventDefault();var e=b(this);e.hasClass("active")||(b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.active").toggleClass("active",!1),e.toggleClass("active",!0),y.printActivitiesActivity({}))}),b("#maxuiactivity-widget-container #maxui-activity-sort").on("click","a.maxui-sort-action.maxui-most-valued",function(t){t.preventDefault();var e=b(this);e.hasClass("active")||(b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.active").toggleClass("active",!1),e.toggleClass("active",!0),y.printActivitiesActivity({sortBy:"likes"}))}),b("#maxuiactivity-widget-container #maxui-activity-sort").on("click","a.maxui-sort-action.maxui-flagged",function(t){t.preventDefault();var e=b(this);e.hasClass("active")||(b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.active").toggleClass("active",!1),e.toggleClass("active",!0),y.printActivitiesActivity({sortBy:"flagged"}))});var t=".maxui-text-input";b("#maxuiactivity-widget-container #maxui-add-people-box").on("focusin",t,function(t){t.preventDefault();var e=b(this).val(),i=b(this).attr("data-literal");y.utils.normalizeWhiteSpace(e,!1)===i&&b(this).val("")}).on("keydown",t,function(t){0<b("#maxuiactivity-widget-container #maxui-conversation-predictive:visible").length&&(40===t.which||38===t.which||13===t.which||9===t.which)&&y.utils.freezeEvent(t)}).on("keyup",t,function(t){t.preventDefault(),t.stopPropagation();var e=b(this).val();""===y.utils.normalizeWhiteSpace(e,!1)?(b(this).attr("class","maxui-empty maxui-text-input"),b(this).removeAttr("title")):y.settings.canwrite&&b(this).attr("class","maxui-text-input");var i=t.which,n=new RegExp("^\\s*([\\u00C0-\\u00FC\\w\\. ]+)\\s*"),a=e.match(n),r=new RegExp("^\\s*([\\u00C0-\\u00FC\\w\\. ]+)\\s*$"),o=e.match(r),s=b("#maxuiactivity-widget-container #maxui-conversation-predictive .maxui-prediction.selected"),c=b(this),u=b("#maxuiactivity-widget-container #maxui-conversation-predictive"),l=u.find(".maxui-prediction").length,d=0<b("#maxuiactivity-widget-container #maxui-conversation-predictive:visible").length;if(40===i&&d&&1<l){var f=s.next();s.removeClass("selected"),0<f.length?f.addClass("selected"):s.siblings(":first").addClass("selected")}else if(38===i&&d&&1<l){var p=s.prev();s.removeClass("selected"),0<p.length?p.addClass("selected"):s.siblings(":last").addClass("selected")}else if(27===i)u.hide();else if(13!==i&&9!==i||!d)"conversations"===y.settings.conversationsSection&&(a?(c.attr("class","maxui-text-input"),o&&(u.show(),u.html("<ul></ul>"),y.printPredictionsActivity(a[1],"#maxui-conversation-predictive"))):(u.hide(),c.attr("class","maxui-empty maxui-text-input"),e.match(new RegExp("^\\s*@"))||(c.attr("class","maxui-text-input error"),c.attr("title",y.settings.literals.post_permission_not_here))));else{var m=s.attr("data-username"),v=s.attr("data-displayname");y.addPersonActivity({username:m,displayName:v}),u.hide(),c.val("").focus()}}).on("focusout",t,function(t){t.preventDefault();var e=b(this).val(),i=b(this).attr("data-literal");""===y.utils.normalizeWhiteSpace(e,!1)&&b(this).val(i)}),y.bindActionBehaviourActivity("#maxui-newactivity","#maxui-newactivity-box",{},function(t){if("timeline"===y.settings.UISection)y.sendActivityActivity(t),b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded",!0);else if("conversations"===y.settings.UISection)if("conversations"===y.settings.conversationsSection){for(var e=b("#maxuiactivity-widget-container #maxui-new-participants")[0],i=[],n=0;n<e.people.length;n++)i.push(e.people[n].username);var a={participants:i,message:b("#maxuiactivity-widget-container #maxui-newactivity textarea").val()};if(1<i.length){var r=b("#maxuiactivity-widget-container #maxui-add-people-box #maxui-new-displayName input").val();a.displayName=r}y.conversations.create(a)}else y.conversations.send(t)},function(t,e,i,n){var a=n.which,r=new RegExp("^\\s*@([\\w\\.]+)\\s*"),o=t.match(r),s=new RegExp("^\\s*@([\\w\\.]+)\\s*$"),c=t.match(s),u=b("#maxuiactivity-widget-container #maxui-newactivity .maxui-prediction.selected"),l=b(e),d=b("#maxuiactivity-widget-container #maxui-newactivity #maxui-predictive"),f=d.find(".maxui-prediction").length,p=0<b("#maxuiactivity-widget-container #maxui-newactivity #maxui-predictive:visible").length;if(40===a&&p&&1<f){var m=u.next();u.removeClass("selected"),0<m.length?m.addClass("selected"):u.siblings(":first").addClass("selected")}else if(38===a&&p&&1<f){var v=u.prev();u.removeClass("selected"),0<v.length?v.addClass("selected"):u.siblings(":last").addClass("selected")}else if(27===a)d.hide();else if(13!==a&&9!==a||!p)""===t?"timeline"===y.settings.UISection&&b(i).val(y.settings.literals.new_activity_post):"timeline"===y.settings.UISection?o?(b(i).val(y.settings.literals.new_message_post),c&&(d.show(),d.html("<ul></ul>"),y.printPredictionsActivity(o[1],"#maxui-newactivity #maxui-predictive")),b(i).removeAttr("disabled"),b(i).attr("class","maxui-button"),l.attr("class","maxui-text-input")):(b(i).val(y.settings.literals.new_activity_post),d.hide(),t.match(new RegExp("^\\s*@"))||y.settings.canwrite||(l.attr("class","maxui-text-input error"),l.attr("title",y.settings.literals.post_permission_unauthorized))):"conversations"===y.settings.UISection&&("conversations"===y.settings.conversationsSection?y.reloadPersonsActivity():"messages"===y.settings.conversationsSection&&(d.hide(),b(i).removeAttr("disabled"),b(i).attr("class","maxui-button"),l.attr("class","maxui-text-input")));else{var h=new RegExp("^\\s*@([\\w\\.]+)"),g=t.replace(h,"@"+u.text()+" ");d.hide(),l.val(g).focus()}}),y.bindActionBehaviourActivity("#maxuiactivity-widget-container #maxui-activities",".maxui-newcommentbox",{},function(t){var e=b(this).closest(".maxui-activity").attr("id");y.maxClient.addComment(t,e,function(){b("#maxuiactivity-widget-container #activityContainer textarea").val("");var t=this.object.inReplyTo[0].id;y.printCommentsForActivityActivity(t),b("#maxuiactivity-widget-container #"+t+" .maxui-newcommentbox textarea").val(""),b("#maxuiactivity-widget-container #"+t+" .maxui-newcommentbox .maxui-button").attr("disabled","disabled")})}),y.bindActionBehaviourActivity("#maxuiactivity-widget-container #maxui-search","#maxui-search-box",{},function(t){y.textSearchActivity(t),b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded",!1),b("#maxuiactivity-widget-container #maxui-search-text").val("")})},b.fn.bindActionBehaviourActivity=function(r,t,o,s){var c=this,e=t+" .maxui-text-input",n=null;4<arguments.length&&(n=arguments[4]),b(r).on("focusin",e,function(t){t.preventDefault();var e=b(this).val(),i=b(this).attr("data-literal");c.utils.normalizeWhiteSpace(e,!1)===i&&b(this).val("")}).on("keydown",e,function(t){if(0<b(r+" #maxui-predictive:visible").length&&(40===t.which||38===t.which||13===t.which||9===t.which))c.utils.freezeEvent(t);else if(13===t.which&&!1===t.shiftKey&&!o.ignore_button){t.preventDefault();var e=b(this).parent().find(".maxui-text-input"),i=e.attr("data-literal"),n=e.val(),a=c.utils.normalizeWhiteSpace(n,!1);a!==i&""!==a&&s.apply(this,[n])}}).on("keyup",e,function(t){t.preventDefault(),t.stopPropagation();var e=b(this).val(),i=b(this).parent().parent().find(".maxui-button");""!==c.utils.normalizeWhiteSpace(e,!1)||o.ignore_button?c.settings.canwrite&&!o.ignore_button&&(b(i).removeAttr("disabled"),b(i).attr("class","maxui-button"),b(this).attr("class","maxui-text-input")):(b(i).attr("disabled","disabled"),b(i).attr("class","maxui-button maxui-disabled"),b(this).attr("class","maxui-empty maxui-text-input"),b(this).removeAttr("title")),null!==n&&n(e,this,i,t)}).on("paste",e,function(t){var e=b(this).parent().parent().find(".maxui-button");c.settings.canwrite&&!o.ignore_button&&(b(e).removeAttr("disabled"),b(e).attr("class","maxui-button"),b(this).attr("class","maxui-text-input"));var i=b(this).val();null!==n&&n(i,this,e,t)}).on("focusout",e,function(t){t.preventDefault();var e=b(this).val(),i=b(this).attr("data-literal");""===c.utils.normalizeWhiteSpace(e,!1)&&b(this).val(i)}).on("click",t+" .maxui-button",function(t){t.preventDefault();var e=b(this).parent().find(".maxui-text-input"),i=e.attr("data-literal"),n=e.val(),a=c.utils.normalizeWhiteSpace(n,!1);(a!==i&""!==a||o.empty_click)&&s.apply(this,[n])})},b.fn.textSearchActivity=function(t){for(var e=this.utils.normalizeWhiteSpace(t).split(" "),i=0;i<e.length;i++){var n="keyword",a=e[i];switch(a[0]){case"#":n="hashtag",a=a.substr(1);break;case"@":n="actor",a=a.substr(1);break;default:n="keyword"}3<=a.length&&this.addFilterActivity({type:n,value:a},!1)}this.reloadFiltersActivity()},b.fn.getFiltersActivity=function(){var t={filters:this.filters};void 0===t.filters&&(t.filters=[]);for(var e={},i=!1,n=0;n<t.filters.length;n++){var a=t.filters[n];a.visible&&(i=!0),e[a.type]||(e[a.type]=[]),e[a.type].push(a.value)}return 0<arguments.length&&(e.before=arguments[0]),{filters:e,visible:i}},b.fn.reloadFiltersActivity=function(){var t,e=this,i={filters:e.filters},n=e.templates.filters.render(i);b("#maxuiactivity-widget-container #maxui-search-filters").html(n),t=0<arguments.length?e.getFiltersActivity(arguments[0]):e.getFiltersActivity(),e.printActivitiesActivity({}),b("#maxuiactivity-widget-container #maxui-search").toggleClass("folded",!t.visible)},b.fn.delFilterActivity=function(t){for(var e=!1,i=0;i<this.filters.length;i++)this.filters[i].value===t.value&this.filters[i].type===t.type&&(e=!0,this.filters.splice(i,1));e&&this.reloadFiltersActivity()},b.fn.addFilterActivity=function(t){var e=this,i=!0;switch(1<arguments.length&&(i=arguments[1]),e.filters||(e.filters=[]),t.hasOwnProperty("visible")||(t.visible=!0),t.type){case"hashtag":t.prepend="#";break;case"actor":t.prepend="@";break;default:t.prepend=""}for(var n=!1,a=0;a<e.filters.length;a++)e.filters[a].value===t.value&e.filters[a].type===t.type&&(n=!0);n||(e.filters.push(t),!0===i&&this.reloadFiltersActivity())},b.fn.reloadPersonsActivity=function(){var t=this,e=b("#maxuiactivity-widget-container #maxui-new-participants"),i=e[0];i.people||(i.people=[]);var n=b("#maxuiactivity-widget-container #maxui-newactivity input.maxui-button"),a=b("#maxuiactivity-widget-container #maxui-newactivity"),r=a.find("textarea").val(),o=a.find("textarea").attr("data-literal");r=t.utils.normalizeWhiteSpace(r);var s=b("#maxuiactivity-widget-container #maxui-add-people-box #maxui-new-displayName"),c=s.find("input").val();c=t.utils.normalizeWhiteSpace(c);var u={persons:i.people},l=t.templates.participants.render(u);(b("#maxuiactivity-widget-container #maxui-new-participants").html(l),b("#maxuiactivity-widget-container #maxui-add-people-box .maxui-label .maxui-count").text("({0}/{1})".format(i.people.length+1,t.settings.maximumConversations)),0<i.people.length)?(1<i.people.length&&!(""!==c)?(n.attr("disabled","disabled"),n.attr("class","maxui-button maxui-disabled"),""===c&&(a.find("textarea").attr("class","maxui-text-input error"),a.find(".maxui-error-box").text(t.settings.literals.post_permission_missing_displayName),a.find(".maxui-error-box").width(a.find("textarea").width()-4),a.find(".maxui-error-box").animate({bottom:-25},200))):(n.removeAttr("disabled"),n.attr("class","maxui-button"),a.find("textarea").attr("class","maxui-text-input"),a.find(".maxui-error-box").width(a.find("textarea").width()-4),a.find(".maxui-error-box").animate({bottom:0},200)),e.show(),a.show(),1<i.people.length?s.show():(s.hide(),s.find(".maxui-text-input").val(""))):""!==r&&r!==o&&(n.attr("disabled","disabled"),n.attr("class","maxui-button maxui-disabled"),e.hide(),a.find("textarea").attr("class","maxui-text-input error"),a.find(".maxui-error-box").text(t.settings.literals.post_permission_not_enough_participants),a.find(".maxui-error-box").width(a.find("textarea").width()-4),a.find(".maxui-error-box").animate({bottom:-25},200),s.hide(),s.find(".maxui-text-input").val(""))},b.fn.delPersonActivity=function(t){for(var e=!1,i=b("#maxuiactivity-widget-container #maxui-new-participants")[0],n=0;n<i.people.length;n++)i.people[n].username===t.username&&(e=!0,i.people.splice(n,1));e&&this.reloadPersonsActivity()},b.fn.addPersonActivity=function(t){var e=b("#maxuiactivity-widget-container #maxui-new-participants")[0],i=!0;1<arguments.length&&(i=arguments[1]);var n=!1;if(e.people||(e.people=[]),t.username!==this.settings.username&&e.people.length<this.settings.maximumConversations-1){for(var a=0;a<e.people.length;a++)e.people[a].username===t.username&&(n=!0);n||(e.people.push(t),!0===i&&this.reloadPersonsActivity())}},b.fn.toggleSectionActivity=function(t){var e,i=this,n=b("#maxuiactivity-widget-container #maxui-search"),a=b("#maxuiactivity-widget-container #maxui-activity-sort"),r=b("#maxuiactivity-widget-container #maxui-timeline"),o=b("#maxuiactivity-widget-container #maxui-timeline .maxui-wrapper"),s=b("#maxuiactivity-widget-container #maxui-conversations"),c=b("#maxuiactivity-widget-container #maxui-common-header"),u=s.find("input#add-user-input"),l=b("#maxuiactivity-widget-container #maxui-conversations #maxui-conversations-list"),d=b("#maxuiactivity-widget-container #maxui-conversations .maxui-wrapper"),f=b("#maxuiactivity-widget-container #maxui-newactivity-box .maxui-button"),p=b("#maxuiactivity-widget-container #maxui-newactivity-box #maxui-subscriptions"),m=b("#maxuiactivity-widget-container #maxui-newactivity"),v=b("#maxuiactivity-widget-container #maxui-newactivity-box textarea"),h=b("#maxuiactivity-widget-container #maxui-show-conversations"),g=b("#maxuiactivity-widget-container #maxui-show-timeline"),y=b("#maxuiactivity-widget-container #maxui-add-people-box"),x=i.width()-i.conversations.scrollbar.width-20-2;if("conversations"===t&&"conversations"===i.settings.currentConversationSection&&(p.attr("style","display:none;"),s.show(),c.removeClass("maxui-showing-messages").addClass("maxui-showing-conversations"),y.show(),u.focus(),s.animate({height:320},400,function(t){d.height(320)}),l.width(x),r.animate({height:0},400),n.hide(400),a.hide(400),i.settings.UISection="conversations",f.val(i.settings.literals.new_message_post),e=i.settings.literals.new_conversation_text,v.val(e).attr("data-literal",e),h.hide(),i.settings.disableTimeline||g.show(),i.conversations.scrollbar.setHeight(275),i.conversations.scrollbar.setTarget("#maxui-conversations #maxui-conversations-list"),m.show()),"timeline"===t){!0===i.settings.showSubscriptionList&&p.attr("style","display:inline;"),i.conversations.listview.toggle(),r.show();var w=o.height();r.animate({height:w},400,function(t){r.css("height","")}),s.animate({height:0},400,function(t){s.hide(),y.hide()}),n.show(400),a.show(400),i.settings.UISection="timeline",f.val(i.settings.literals.new_activity_post),e=i.settings.literals.new_activity_text,v.val(e).attr("data-literal",e),i.settings.disableConversations||h.show(),g.hide(),i.settings.hidePostboxOnTimeline&&m.hide(),i.hidePostboxActivity()&&m.hide()}},b.fn.Settings=function(){return this.settings},b.fn.sendActivityActivity=function(){var i=this,t=b("#maxuiactivity-widget-container #maxui-newactivity textarea").val(),e=[];b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.active").toggleClass("active",!1),b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.maxui-most-recent").toggleClass("active",!0),e.push(t),e.push(i.settings.writeContexts),e.push(function(){b("#maxuiactivity-widget-container #maxui-newactivity textarea").val(""),b("#maxuiactivity-widget-container #maxui-newactivity .maxui-button").attr("disabled","disabled");var t=b(".maxui-activity:first");if(0<t.length){var e={after:t.attr("id")};i.printActivitiesActivity(e)}else i.printActivitiesActivity({})}),i.settings.generatorName&&e.push(i.settings.generatorName),i.maxClient.addActivity.apply(i.maxClient,e),b("#maxui-subscriptions option:first-child").attr("selected","selected")},b.fn.loadMoreActivitiesActivity=function(){var t=b(".maxui-activity:last").attr("id");b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.maxui-most-recent").hasClass("active")&&0<b("#"+t+" .maxui-comment").length&&(t=b("#"+t+" .maxui-comment:last").attr("id"));var e={before:t};this.printActivitiesActivity(e)},b.fn.loadNewsActivitiesActivity=function(){this.printActivitiesActivity()},b.fn.printPredictionsActivity=function(t,e){var i=this,n=[];n.push(t),n.push(function(t){i.formatPredictionsActivity(t,e)}),this.maxClient.getUsersList.apply(this.maxClient,n)},b.fn.formatPredictionsActivity=function(t,e){for(var i="",n=0;n<t.length;n++){var a=t[n];if(a.username!==this.username){var r=this.settings.avatarURLpattern.format(a.username),o={username:a.username,displayName:a.displayName,avatarURL:r,cssclass:"maxui-prediction"+(0===n?" selected":"")};i+=this.templates.predictive.render(o)}}(""===i&&(i="<li>"+this.settings.literals.no_match_found+"</li>"),b(e+" ul").html(i),2<arguments.length)&&(0,arguments[2])()},b.fn.canCommentActivityActivity=function(t){for(var e in this.settings.subscriptionsWrite){if(this.settings.subscriptionsWrite[e].hash===t)return!0}return!1},b.fn.formatActivitiesActivity=function(t,e){for(var n=this,i="",a=[],r=0;r<t.length;r++){var o=t[r],s=null;o.hasOwnProperty("contexts")&&0<o.contexts.length&&(s=o.contexts[0]);var c=null;o.hasOwnProperty("generator")&&o.generator!==n.settings.generatorName&&(c=o.generator);var u="";"person"===o.actor.objectType?u=n.settings.avatarURLpattern.format(o.actor.username):"context"===o.actor.objectType&&(u=n.settings.contextAvatarURLpattern.format(o.actor.hash));var l=[],d="";if(o.replies&&0<o.replies.length){for(var f=0;f<o.replies.length;f++){var p=o.replies[f],m={id:p.id,actor:p.actor,date:n.utils.formatDate(p.published,n.language),text:n.utils.formatText(p.content),avatarURL:n.settings.avatarURLpattern.format(p.actor.username),canDeleteComment:p.deletable,literals:n.settings.literals};l.push(m)}d="Comentat "+l[l.length-1].date}_.defaults(o.object,{filename:o.id});var v=n.settings.canwrite;o.contexts&&(v=n.canCommentActivityActivity(o.contexts[0].url));var h={id:o.id,actor:o.actor,auth:{token:n.settings.oAuthToken,username:n.settings.username},literals:n.settings.literals,date:n.utils.formatDate(o.published,n.language),dateLastComment:d,text:n.utils.formatText(o.object.content),replies:l,favorited:o.favorited,likes:o.likesCount?o.likesCount:0,showLikesCount:"likes"===n.currentSortOrder,liked:o.liked,flagged:o.flagged,avatarURL:u,publishedIn:s,canDeleteActivity:o.deletable,canFlagActivity:n.settings.canflag,via:c,fileDownload:"file"===o.object.objectType,filename:o.object.filename,canViewComments:v||0<o.replies.length,canWriteComment:v},g={comment:n.templates.comment};i+=n.templates.activity.render(h,g),"image"===o.object.objectType&&a.push(o)}if("beggining"===e){b("#maxuiactivity-widget-container #maxui-preload .maxui-wrapper").prepend(i);var y=b("#maxuiactivity-widget-container #maxui-preload .maxui-wrapper .maxui-activity"),x=0;for(r=0;r<y.length;r++)x+=b(y[r]).height()+18;var w=b("#maxuiactivity-widget-container #maxui-preload").height();b("#maxuiactivity-widget-container #maxui-preload").height(x-w),b("#maxuiactivity-widget-container #maxui-preload").css({"margin-top":-1*(x-w)}),b("#maxuiactivity-widget-container #maxui-preload").animate({"margin-top":0},200,function(){b("#maxuiactivity-widget-container #maxui-preload .maxui-wrapper").html(""),b("#maxuiactivity-widget-container #maxui-activities").prepend(i),b("#maxuiactivity-widget-container #maxui-preload").height(0)})}else"end"===e?b("#maxuiactivity-widget-container #maxui-activities").append(i):b("#maxuiactivity-widget-container #maxui-activities").html(i);2<arguments.length&&arguments[2].call(),_.each(a,function(i,t,e){n.maxClient.getMessageImage("/activities/{0}/image/thumb".format(i.id),function(t){var e='<img class="maxui-embedded" alt="" src="data:image/png;base64,{0}" />'.format(t);b(".maxui-activity#{0} .maxui-activity-message .maxui-body".format(i.id)).after(e)})})},b.fn.formatCommentActivity=function(t,e){for(var i=this,n="",a=0;a<t.length;a++){var r=t[a],o={literals:i.settings.literals,id:r.id,actor:r.actor,date:i.utils.formatDate(r.published,i.language),text:i.utils.formatText(r.content),avatarURL:i.settings.avatarURLpattern.format(r.actor.username),canDeleteComment:r.deletable};n+=i.templates.comment.render(o)}b(".maxui-activity#"+e+" .maxui-commentsbox").html(n);var s=b(".maxui-activity#"+e+" .maxui-commentaction strong");b(s).text(parseInt(b(s).text(),10)+1)},b.fn.renderPostboxActivity=function(){var t=this,e="conversations"===t.settings.UISection,i=!1===t.settings.disableConversations&&!e,n={avatar:t.settings.avatarURLpattern.format(t.settings.username),allowPosting:t.settings.canwrite,buttonLiteral:t.settings.literals.new_activity_post,textLiteral:t.settings.literals.new_activity_text,literals:t.settings.literals,showConversationsToggle:i?"display:block;":"display:none;",showSubscriptionList:t.settings.showSubscriptionList&&0<t.settings.subscriptionsWrite.length,subscriptionList:t.settings.subscriptionsWrite},a=t.templates.postBox.render(n);b("#maxuiactivity-widget-container #maxui-newactivity").html(a)},b.fn.printActivitiesActivity=function(t){var r=this,e=[],o="replace",i=r.getFiltersActivity().filters;b.extend(i,t),i.before&&(o="end"),i.after&&(o="beggining"),i.sortBy||(b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.maxui-most-valued").hasClass("active")?i.sortBy="likes":b("#maxuiactivity-widget-container #maxui-activity-sort .maxui-sort-action.maxui-flagged").hasClass("active")?i.sortBy="flagged":i.sortBy=r.settings.activitySortOrder),r.currentSortOrder=i.sortBy;var n=null;if("timeline"===r.settings.activitySource)n=this.maxClient.getUserTimeline,e.push(r.settings.username);else if("activities"===r.settings.activitySource){n=this.maxClient.getActivities;var a={context:r.settings.readContextHash,tags:r.settings.contextTagsFilter};e.push(a)}if(1<arguments.length){var s=arguments[1];e.push(function(a){r.settings.canwrite=!0,"activities"===r.settings.activitySource?r.maxClient.getContext(r.settings.readContextHash,function(t){var e=r.settings.subscriptions;e[t.hash]||(e[t.hash]={},e[t.hash].permissions={},e[t.hash].permissions.read="public"===t.permissions.read,e[t.hash].permissions.write="public"===t.permissions.write);for(var i=0;i<r.settings.writeContexts.length;i++){var n=r.settings.writeContextsHashes[i];e[n].permissions?(!0!==e[n].permissions.write&&(r.settings.canwrite=!1),!0===e[n].permissions.flag?r.settings.canflag=!0:r.settings.canflag=!1):(r.settings.canwrite=!1,r.settings.canflag=!1)}r.renderPostboxActivity(),r.formatActivitiesActivity(a,o,s)}):(r.renderPostboxActivity(a,o,s),r.formatActivitiesActivity(a,o,s))})}else e.push(function(t){r.formatActivitiesActivity(t,o)});e.push(i),n.apply(this.maxClient,e)},b.fn.printCommentsForActivityActivity=function(e){var i=this,t=[];t.push(e),t.push(function(t){i.formatCommentActivity(t,e)}),this.maxClient.getCommentsForActivity.apply(this.maxClient,t)},b.maxui=function(){},b.maxui.settings=function(){return this.settings}}(jQuery),window.setTimeout(function(){window._MAXUI_Activity&&window._MAXUI_Activity.onReady&&!window._MAXUI_Activity.hasRun&&(window._MAXUI_Activity.hasRun=!0,_MAXUI_Activity.onReady())},0);
//# sourceMappingURL=maxuiactivity.min.js.map